<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-eval'; style-src 'self' 'unsafe-inline'">
  <title>GSD Viewer</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    :root {
      --flash-duration: 2000ms;
    }

    html, body {
      width: 100%;
      height: 100%;
      background-color: #1a1a2e;
      color: #eee;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
      overflow: hidden;
    }

    #toolbar {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      height: 50px;
      background: rgba(26, 26, 46, 0.95);
      border-bottom: 1px solid #333;
      display: flex;
      align-items: center;
      padding: 0 16px;
      gap: 16px;
      z-index: 100;
    }

    #toolbar button {
      background: #4ecdc4;
      color: #1a1a2e;
      border: none;
      padding: 8px 16px;
      border-radius: 4px;
      cursor: pointer;
      font-weight: 500;
      transition: background 0.2s;
    }

    #toolbar button:hover {
      background: #45b7d1;
    }

    #selected-path {
      color: #888;
      font-size: 0.9rem;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }

    #graph-container {
      width: 100%;
      height: 100%;
      position: absolute;
      top: 50px;
      left: 0;
      bottom: 0;
    }

    #color-legend {
      position: fixed;
      bottom: 20px;
      left: 20px;
      background: rgba(0, 0, 0, 0.7);
      border-radius: 8px;
      font-size: 12px;
      z-index: 100;
      max-height: calc(100vh - 250px);
      overflow: hidden;
      transition: max-height 0.3s ease;
    }

    #color-legend.collapsed {
      max-height: 36px;
    }

    #legend-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 10px 12px;
      cursor: pointer;
      border-bottom: 1px solid rgba(255,255,255,0.1);
      user-select: none;
    }

    #legend-header:hover {
      background: rgba(255,255,255,0.05);
    }

    #legend-header .legend-header-title {
      font-weight: 600;
      color: #4ECDC4;
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    #legend-header .legend-toggle-icon {
      color: #888;
      font-size: 10px;
      transition: transform 0.3s ease;
    }

    #color-legend.collapsed #legend-header .legend-toggle-icon {
      transform: rotate(180deg);
    }

    #legend-content {
      padding: 8px 12px 12px;
      overflow-y: auto;
      max-height: calc(100vh - 290px);
    }

    #color-legend.collapsed #legend-content {
      display: none;
    }

    #color-legend .legend-title {
      font-weight: 600;
      margin-bottom: 8px;
      color: #ccc;
    }

    #color-legend .legend-item {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-bottom: 4px;
    }

    #color-legend .legend-color {
      width: 12px;
      height: 12px;
      border-radius: 50%;
    }

    #color-legend .legend-label {
      color: #aaa;
    }

    /* Scrollbar for legend content */
    #legend-content::-webkit-scrollbar {
      width: 6px;
    }

    #legend-content::-webkit-scrollbar-track {
      background: transparent;
    }

    #legend-content::-webkit-scrollbar-thumb {
      background: rgba(255,255,255,0.2);
      border-radius: 3px;
    }

    /* Minimap Panel */
    #minimap-panel {
      position: fixed;
      bottom: 20px;
      right: 20px;
      background: rgba(0, 0, 0, 0.7);
      border-radius: 8px;
      border: 1px solid rgba(78, 205, 196, 0.3);
      z-index: 100;
      overflow: hidden;
      transition: max-height 0.3s ease, background 0.2s ease;
    }

    #minimap-panel:hover:not(.collapsed) {
      background: rgba(0, 0, 0, 0.85);
    }

    #minimap-panel.collapsed {
      max-height: 36px;
    }

    #minimap-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 10px 12px;
      cursor: pointer;
      border-bottom: 1px solid rgba(255,255,255,0.1);
      user-select: none;
    }

    #minimap-header:hover {
      background: rgba(255,255,255,0.05);
    }

    #minimap-header .minimap-header-title {
      font-weight: 600;
      color: #4ECDC4;
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    #minimap-header .minimap-toggle-icon {
      color: #888;
      font-size: 10px;
      transition: transform 0.3s ease;
    }

    #minimap-panel.collapsed #minimap-header .minimap-toggle-icon {
      transform: rotate(180deg);
    }

    #minimap-content {
      padding: 8px;
    }

    #minimap-panel.collapsed #minimap-content {
      display: none;
    }

    #minimap-canvas {
      display: block;
      border: 1px solid rgba(255,255,255,0.1);
      border-radius: 4px;
      cursor: pointer;
      background: rgba(26, 26, 46, 0.5);
      transition: border-color 0.2s ease, box-shadow 0.2s ease;
    }

    #minimap-canvas:hover {
      border-color: rgba(78, 205, 196, 0.5);
      box-shadow: 0 0 8px rgba(78, 205, 196, 0.2);
    }

    /* Details Panel */
    #details-panel {
      position: fixed;
      right: 0;
      top: 0;
      width: 420px;
      height: 100%;
      background: rgba(26, 26, 46, 0.98);
      border-left: 1px solid #4ECDC4;
      padding: 60px 20px 20px;
      transform: translateX(100%);
      transition: transform 0.3s ease;
      z-index: 200;
      overflow-y: auto;
    }

    /* File Preview */
    #file-preview-container {
      margin-top: 15px;
      border-top: 1px solid #333;
      padding-top: 15px;
    }

    #file-preview {
      background: #1e1e2e;
      border: 1px solid #333;
      border-radius: 4px;
      padding: 12px;
      font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
      font-size: 11px;
      line-height: 1.5;
      max-height: 400px;
      overflow: auto;
      white-space: pre-wrap;
      word-wrap: break-word;
      color: #ABB2BF;
    }

    #file-preview-loading {
      color: #888;
      font-style: italic;
    }

    #details-panel.visible {
      transform: translateX(0);
    }

    #details-panel.hidden {
      transform: translateX(100%);
    }

    #close-panel {
      position: absolute;
      top: 15px;
      right: 15px;
      background: none;
      border: none;
      color: #fff;
      font-size: 28px;
      cursor: pointer;
      opacity: 0.7;
      transition: opacity 0.2s;
    }

    #close-panel:hover {
      opacity: 1;
    }

    #panel-title {
      font-size: 1.2rem;
      margin-bottom: 15px;
      color: #4ECDC4;
      word-break: break-word;
    }

    #panel-content {
      color: #ccc;
      line-height: 1.6;
    }

    #panel-content p {
      margin-bottom: 10px;
    }

    #panel-content strong {
      color: #fff;
    }

    .panel-btn {
      margin-top: 15px;
      padding: 10px 16px;
      background: #4ECDC4;
      border: none;
      border-radius: 4px;
      color: #1a1a2e;
      cursor: pointer;
      font-weight: bold;
      width: 100%;
      transition: background 0.2s;
    }

    .panel-btn:hover {
      background: #45B7D1;
    }

    /* Tooltip */
    #tooltip {
      position: fixed;
      padding: 10px 14px;
      background: rgba(0, 0, 0, 0.9);
      color: #fff;
      border-radius: 6px;
      font-size: 12px;
      pointer-events: none;
      z-index: 1001;
      max-width: 280px;
      display: none;
      border: 1px solid rgba(78, 205, 196, 0.4);
      box-shadow: 0 4px 12px rgba(0,0,0,0.3);
    }

    #tooltip.visible {
      display: block;
    }

    /* Toolbar additions */
    #toolbar button:disabled {
      opacity: 0.6;
      cursor: not-allowed;
    }

    #recent-projects {
      background: #2a2a4e;
      color: #eee;
      border: 1px solid #4ECDC4;
      padding: 8px 12px;
      border-radius: 4px;
      cursor: pointer;
      font-size: 0.9rem;
      max-width: 200px;
    }

    #recent-projects:focus {
      outline: none;
      border-color: #45B7D1;
    }

    #recent-projects option {
      background: #2a2a4e;
      color: #eee;
    }

    /* Refresh indicator */
    #refresh-indicator {
      position: fixed;
      top: 60px;
      right: 20px;
      background: rgba(78, 205, 196, 0.9);
      color: #1a1a2e;
      padding: 8px 16px;
      border-radius: 4px;
      font-size: 12px;
      font-weight: 500;
      opacity: 0;
      transition: opacity 0.3s;
      z-index: 150;
    }

    #refresh-indicator.visible {
      opacity: 1;
    }

    /* Tree Panel */
    #tree-panel {
      position: fixed;
      left: 0;
      top: 50px;
      width: 280px;
      height: calc(100% - 50px);
      background: rgba(26, 26, 46, 0.98);
      border-right: 1px solid #333;
      z-index: 90;
      transform: translateX(-100%);
      transition: transform 0.3s ease;
      display: flex;
      flex-direction: column;
    }

    #tree-panel.visible {
      transform: translateX(0);
    }

    #tree-resizer {
      position: absolute;
      right: 0;
      top: 0;
      width: 6px;
      height: 100%;
      cursor: col-resize;
      background: transparent;
      z-index: 100;
      transition: background 0.2s;
    }

    #tree-resizer:hover,
    #tree-resizer.active {
      background: rgba(78, 205, 196, 0.5);
    }

    #tree-resizer::after {
      content: '';
      position: absolute;
      left: 2px;
      top: 50%;
      transform: translateY(-50%);
      width: 2px;
      height: 40px;
      background: rgba(78, 205, 196, 0.3);
      border-radius: 1px;
    }

    #tree-resizer:hover::after,
    #tree-resizer.active::after {
      background: rgba(78, 205, 196, 0.8);
    }

    body.resizing {
      cursor: col-resize !important;
      user-select: none;
    }

    body.resizing * {
      cursor: col-resize !important;
    }

    #tree-toggle {
      position: fixed;
      left: 10px;
      top: 60px;
      background: rgba(78, 205, 196, 0.9);
      color: #1a1a2e;
      border: none;
      width: 32px;
      height: 32px;
      border-radius: 4px;
      cursor: pointer;
      font-size: 16px;
      z-index: 95;
      transition: left 0.3s ease, background 0.2s;
    }

    #tree-toggle:hover {
      background: #45B7D1;
    }

    #tree-toggle.panel-open {
      left: 290px;
    }

    #tree-header {
      padding: 12px 16px;
      border-bottom: 1px solid #333;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }

    #tree-header h3 {
      margin: 0;
      font-size: 14px;
      color: #4ECDC4;
    }

    #tree-content {
      flex: 1;
      overflow-y: auto;
      overflow-x: hidden;
      padding: 8px 0;
    }

    .tree-item {
      display: flex;
      align-items: center;
      padding: 4px 8px;
      cursor: pointer;
      transition: background 0.15s;
      white-space: nowrap;
      font-size: 13px;
      color: #ccc;
    }

    .tree-item:hover {
      background: rgba(78, 205, 196, 0.15);
    }

    .tree-item.selected {
      background: rgba(78, 205, 196, 0.3);
      color: #fff;
    }

    .tree-item.highlighted {
      background: rgba(78, 205, 196, 0.25);
      border-left: 3px solid #4ECDC4;
    }

    @keyframes tree-flash {
      0% {
        background-color: rgba(255, 255, 255, 0.9);
        box-shadow: 0 0 15px rgba(255, 255, 255, 0.8);
      }
      15% {
        background-color: rgba(255, 255, 255, 0.3);
        box-shadow: 0 0 5px rgba(255, 255, 255, 0.3);
      }
      30% {
        background-color: rgba(255, 255, 255, 0.8);
        box-shadow: 0 0 12px rgba(255, 255, 255, 0.7);
      }
      45% {
        background-color: rgba(255, 255, 255, 0.2);
        box-shadow: 0 0 3px rgba(255, 255, 255, 0.2);
      }
      60% {
        background-color: rgba(255, 255, 255, 0.6);
        box-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
      }
      100% {
        background-color: transparent;
        box-shadow: none;
      }
    }

    .tree-flash {
      animation: tree-flash var(--flash-duration) ease-out;
      color: #1a1a2e !important; /* Dark text during flash for contrast */
    }

    /* Change-type-specific tree flash animations - Enhanced with brighter colors and glow */
    /* Created: 4 quick pulses with neon green (0x00FF88 = rgba(0, 255, 136)) */
    @keyframes tree-flash-created {
      0% {
        background-color: rgba(0, 255, 136, 1.0);
        box-shadow: 0 0 20px rgba(0, 255, 136, 0.9), inset 0 0 10px rgba(0, 255, 136, 0.5);
        text-shadow: 0 0 8px rgba(0, 255, 136, 0.8);
      }
      10% { background-color: rgba(0, 255, 136, 0.1); box-shadow: none; text-shadow: none; }
      20% {
        background-color: rgba(0, 255, 136, 0.95);
        box-shadow: 0 0 25px rgba(0, 255, 136, 0.85), inset 0 0 10px rgba(0, 255, 136, 0.4);
        text-shadow: 0 0 8px rgba(0, 255, 136, 0.7);
      }
      30% { background-color: rgba(0, 255, 136, 0.1); box-shadow: none; text-shadow: none; }
      40% {
        background-color: rgba(0, 255, 136, 0.9);
        box-shadow: 0 0 22px rgba(0, 255, 136, 0.8), inset 0 0 8px rgba(0, 255, 136, 0.4);
        text-shadow: 0 0 6px rgba(0, 255, 136, 0.6);
      }
      50% { background-color: rgba(0, 255, 136, 0.1); box-shadow: none; text-shadow: none; }
      60% {
        background-color: rgba(0, 255, 136, 0.8);
        box-shadow: 0 0 18px rgba(0, 255, 136, 0.7), inset 0 0 6px rgba(0, 255, 136, 0.3);
        text-shadow: 0 0 5px rgba(0, 255, 136, 0.5);
      }
      70% { background-color: rgba(0, 255, 136, 0.1); box-shadow: none; text-shadow: none; }
      80% {
        background-color: rgba(0, 255, 136, 0.6);
        box-shadow: 0 0 15px rgba(0, 255, 136, 0.5);
        text-shadow: 0 0 4px rgba(0, 255, 136, 0.4);
      }
      100% { background-color: transparent; box-shadow: none; text-shadow: none; }
    }

    /* Modified: 3 steady pulses with bright amber (0xFFAA00 = rgba(255, 170, 0)) */
    @keyframes tree-flash-modified {
      0% {
        background-color: rgba(255, 170, 0, 1.0);
        box-shadow: 0 0 20px rgba(255, 170, 0, 0.9), inset 0 0 10px rgba(255, 170, 0, 0.5);
        text-shadow: 0 0 8px rgba(255, 170, 0, 0.8);
      }
      16% { background-color: rgba(255, 170, 0, 0.1); box-shadow: none; text-shadow: none; }
      33% {
        background-color: rgba(255, 170, 0, 0.95);
        box-shadow: 0 0 22px rgba(255, 170, 0, 0.85), inset 0 0 8px rgba(255, 170, 0, 0.4);
        text-shadow: 0 0 7px rgba(255, 170, 0, 0.7);
      }
      50% { background-color: rgba(255, 170, 0, 0.1); box-shadow: none; text-shadow: none; }
      66% {
        background-color: rgba(255, 170, 0, 0.85);
        box-shadow: 0 0 18px rgba(255, 170, 0, 0.75), inset 0 0 6px rgba(255, 170, 0, 0.3);
        text-shadow: 0 0 6px rgba(255, 170, 0, 0.6);
      }
      83% { background-color: rgba(255, 170, 0, 0.1); box-shadow: none; text-shadow: none; }
      100% { background-color: transparent; box-shadow: none; text-shadow: none; }
    }

    /* Deleted: 2 slow pulses then fade with bright red (0xFF3333 = rgba(255, 51, 51)) */
    @keyframes tree-flash-deleted {
      0% {
        background-color: rgba(255, 51, 51, 1.0);
        box-shadow: 0 0 20px rgba(255, 51, 51, 0.9), inset 0 0 10px rgba(255, 51, 51, 0.5);
        text-shadow: 0 0 8px rgba(255, 51, 51, 0.8);
      }
      25% { background-color: rgba(255, 51, 51, 0.1); box-shadow: none; text-shadow: none; }
      50% {
        background-color: rgba(255, 51, 51, 0.9);
        box-shadow: 0 0 18px rgba(255, 51, 51, 0.8), inset 0 0 8px rgba(255, 51, 51, 0.4);
        text-shadow: 0 0 6px rgba(255, 51, 51, 0.7);
      }
      75% { background-color: rgba(255, 51, 51, 0.1); box-shadow: none; text-shadow: none; }
      90% {
        background-color: rgba(255, 51, 51, 0.5);
        box-shadow: 0 0 10px rgba(255, 51, 51, 0.4);
        opacity: 0.7;
      }
      100% { background-color: transparent; box-shadow: none; text-shadow: none; opacity: 0.5; }
    }

    .tree-flash-created {
      animation: tree-flash-created var(--flash-duration) ease-out;
      color: #1a1a2e !important;
    }

    .tree-flash-modified {
      animation: tree-flash-modified var(--flash-duration) ease-out;
      color: #1a1a2e !important;
    }

    .tree-flash-deleted {
      animation: tree-flash-deleted var(--flash-duration) ease-out;
      color: #1a1a2e !important;
    }

    .tree-toggle-icon {
      width: 16px;
      height: 16px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      margin-right: 4px;
      color: #888;
      font-size: 10px;
      transition: transform 0.2s;
    }

    .tree-toggle-icon.expanded {
      transform: rotate(90deg);
    }

    .tree-toggle-icon.no-children {
      visibility: hidden;
    }

    .tree-icon {
      margin-right: 6px;
      font-size: 14px;
    }

    .tree-name {
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .tree-children {
      display: none;
    }

    .tree-children.expanded {
      display: block;
    }

    /* Adjust graph container when tree is open */
    #graph-container.tree-open {
      left: 280px;
      width: calc(100% - 280px);
    }

    /* Adjust graph container when activity panel is open */
    #graph-container.activity-open {
      bottom: 180px;
      height: calc(100% - 50px - 180px);
    }

    /* Activity Feed Toggle Button */
    #activity-toggle {
      position: fixed;
      left: 10px;
      bottom: 10px;
      background: rgba(78, 205, 196, 0.9);
      color: #1a1a2e;
      border: none;
      padding: 6px 12px;
      border-radius: 4px;
      cursor: pointer;
      font-size: 12px;
      font-weight: 500;
      z-index: 95;
      transition: bottom 0.3s ease, background 0.2s;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    #activity-toggle:hover {
      background: #45B7D1;
    }

    #activity-toggle.panel-open {
      bottom: 190px;
    }

    #activity-toggle.pulse {
      animation: toggle-pulse 0.6s ease-out;
    }

    @keyframes toggle-pulse {
      0% { transform: scale(1); box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2); }
      50% { transform: scale(1.1); box-shadow: 0 0 15px rgba(78, 205, 196, 0.8); }
      100% { transform: scale(1); box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2); }
    }

    /* Activity Badge */
    #activity-badge {
      display: none;
      background: #E74C3C;
      color: #fff;
      font-size: 10px;
      font-weight: bold;
      min-width: 16px;
      height: 16px;
      border-radius: 8px;
      padding: 0 4px;
      text-align: center;
      line-height: 16px;
    }

    #activity-badge.visible {
      display: inline-block;
    }

    @keyframes badge-pulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.2); }
    }

    #activity-badge.pulse {
      animation: badge-pulse 1s ease-in-out infinite;
    }

    /* Activity Feed Panel */
    #activity-panel {
      position: fixed;
      left: 0;
      right: 0;
      bottom: 0;
      height: 180px;
      background: rgba(26, 26, 46, 0.98);
      border-top: 1px solid #333;
      z-index: 90;
      transform: translateY(100%);
      transition: transform 0.3s ease;
      display: flex;
      flex-direction: column;
    }

    #activity-panel.visible {
      transform: translateY(0);
    }

    #activity-header {
      padding: 8px 16px;
      border-bottom: 1px solid #333;
      display: flex;
      align-items: center;
      justify-content: space-between;
      flex-shrink: 0;
    }

    #activity-header h3 {
      margin: 0;
      font-size: 13px;
      color: #4ECDC4;
      font-weight: 500;
    }

    /* Timeline Controls */
    #timeline-controls {
      display: flex;
      align-items: center;
      gap: 8px;
      flex: 1;
      justify-content: center;
    }

    #timeline-scrubber {
      width: 120px;
      height: 4px;
      -webkit-appearance: none;
      background: rgba(255,255,255,0.2);
      border-radius: 2px;
      outline: none;
      cursor: pointer;
    }

    #timeline-scrubber::-webkit-slider-thumb {
      -webkit-appearance: none;
      width: 12px;
      height: 12px;
      background: #4ECDC4;
      border-radius: 50%;
      cursor: pointer;
      transition: background 0.2s;
    }

    #timeline-scrubber::-webkit-slider-thumb:hover {
      background: #45B7D1;
    }

    #timeline-play {
      width: 24px;
      height: 24px;
      border-radius: 50%;
      background: #4ECDC4;
      border: none;
      color: #1a1a2e;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 10px;
      transition: background 0.2s;
      padding: 0;
    }

    #timeline-play:hover {
      background: #45B7D1;
    }

    #timeline-position {
      font-size: 11px;
      color: #888;
      min-width: 50px;
      text-align: center;
    }

    #timeline-live {
      font-size: 10px;
      color: #2ECC71;
      font-weight: bold;
      padding: 2px 6px;
      background: rgba(46, 204, 113, 0.2);
      border-radius: 3px;
      display: none;
    }

    #timeline-live.visible {
      display: inline-block;
    }

    /* Timeline mode indicator */
    .timeline-historical-mode #activity-panel {
      border-top-color: #F39C12;
    }

    .activity-entry.future {
      opacity: 0.4;
    }

    #activity-clear {
      background: transparent;
      border: 1px solid #555;
      color: #888;
      padding: 4px 10px;
      border-radius: 3px;
      cursor: pointer;
      font-size: 11px;
      transition: all 0.2s;
    }

    #activity-clear:hover {
      border-color: #E74C3C;
      color: #E74C3C;
    }

    #activity-content {
      flex: 1;
      overflow-y: auto;
      overflow-x: hidden;
      padding: 4px 0;
    }

    /* Custom scrollbar for activity content */
    #activity-content::-webkit-scrollbar {
      width: 6px;
    }

    #activity-content::-webkit-scrollbar-track {
      background: rgba(0, 0, 0, 0.2);
    }

    #activity-content::-webkit-scrollbar-thumb {
      background: #4ECDC4;
      border-radius: 3px;
    }

    #activity-content::-webkit-scrollbar-thumb:hover {
      background: #45B7D1;
    }

    /* Activity Entry */
    .activity-entry {
      display: flex;
      align-items: center;
      padding: 6px 16px;
      font-size: 12px;
      color: #ccc;
      cursor: pointer;
      transition: background 0.15s;
      border-left: 3px solid transparent;
    }

    .activity-entry:hover {
      background: rgba(78, 205, 196, 0.2);
      cursor: pointer;
    }

    .activity-entry.created:hover {
      background: rgba(46, 204, 113, 0.2);
    }

    .activity-entry.modified:hover {
      background: rgba(243, 156, 18, 0.2);
    }

    .activity-entry.deleted:hover {
      background: rgba(231, 76, 60, 0.2);
    }

    .activity-entry .entry-icon,
    .activity-entry .activity-icon {
      margin-right: 8px;
      font-size: 14px;
      font-weight: bold;
      width: 16px;
      text-align: center;
    }

    .activity-entry .entry-path,
    .activity-entry .activity-path {
      flex: 1;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }

    .activity-entry .entry-type,
    .activity-entry .activity-type {
      margin-left: 8px;
      padding: 2px 6px;
      border-radius: 3px;
      font-size: 10px;
      font-weight: 500;
      text-transform: capitalize;
    }

    .activity-entry .entry-time,
    .activity-entry .activity-time {
      margin-left: 12px;
      color: #666;
      font-size: 11px;
      flex-shrink: 0;
    }

    /* Activity Entry Types - Color Coding */
    .activity-entry.created {
      border-left-color: #2ECC71;
    }

    .activity-entry.created .entry-type,
    .activity-entry.created .activity-type {
      background: rgba(46, 204, 113, 0.2);
      color: #2ECC71;
    }

    .activity-entry.created .activity-icon {
      color: #2ECC71;
    }

    .activity-entry.modified {
      border-left-color: #F39C12;
    }

    .activity-entry.modified .entry-type,
    .activity-entry.modified .activity-type {
      background: rgba(243, 156, 18, 0.2);
      color: #F39C12;
    }

    .activity-entry.modified .activity-icon {
      color: #F39C12;
    }

    .activity-entry.deleted {
      border-left-color: #E74C3C;
    }

    .activity-entry.deleted .entry-type,
    .activity-entry.deleted .activity-type {
      background: rgba(231, 76, 60, 0.2);
      color: #E74C3C;
    }

    .activity-entry.deleted .activity-icon {
      color: #E74C3C;
    }

    /* Empty state */
    .activity-empty {
      padding: 20px;
      text-align: center;
      color: #666;
      font-size: 12px;
      font-style: italic;
    }

    /* Diff View Styles */
    .diff-container {
      margin-top: 16px;
      border: 1px solid #333;
      border-radius: 4px;
      overflow: hidden;
    }
    .diff-header {
      background: #2a2a4e;
      padding: 8px 12px;
      font-weight: bold;
      border-bottom: 1px solid #333;
    }
    .diff-content {
      max-height: 300px;
      overflow-y: auto;
      font-family: 'Consolas', 'Monaco', monospace;
      font-size: 12px;
      line-height: 1.4;
    }
    .diff-line {
      padding: 2px 8px;
      white-space: pre-wrap;
      word-break: break-all;
    }
    .diff-line.added {
      background: rgba(46, 204, 113, 0.2);
      color: #2ECC71;
    }
    .diff-line.removed {
      background: rgba(231, 76, 60, 0.2);
      color: #E74C3C;
    }
    .diff-line.header {
      background: rgba(52, 152, 219, 0.2);
      color: #3498DB;
    }
    .diff-line.context {
      color: #888;
    }
    .diff-status {
      padding: 12px;
      color: #888;
      font-style: italic;
    }

    /* Zoom Preset Buttons */
    #zoom-presets {
      display: flex;
      align-items: center;
      gap: 2px;
      margin-left: 10px;
      padding: 2px;
      background: rgba(255, 255, 255, 0.05);
      border-radius: 4px;
    }

    .zoom-btn {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 28px;
      height: 24px;
      background: rgba(100, 149, 237, 0.15);
      border: 1px solid rgba(100, 149, 237, 0.3);
      border-radius: 3px;
      color: rgba(100, 149, 237, 0.8);
      font-size: 12px;
      cursor: pointer;
      transition: all 0.2s;
    }

    .zoom-btn:hover {
      background: rgba(100, 149, 237, 0.3);
      border-color: rgba(100, 149, 237, 0.6);
      color: #6495ED;
    }

    .zoom-btn:active {
      background: rgba(100, 149, 237, 0.4);
      transform: scale(0.95);
    }

    .zoom-btn span {
      font-size: 14px;
    }

    /* Disable state for focus/detail when no node selected */
    .zoom-btn.disabled {
      opacity: 0.4;
      cursor: not-allowed;
      pointer-events: none;
    }

    /* Orbit Mode Toggle */
    #orbit-toggle {
      display: flex;
      align-items: center;
      gap: 6px;
      padding: 6px 12px;
      margin-left: 10px;
      background: rgba(100, 149, 237, 0.15);
      border: 1px solid rgba(100, 149, 237, 0.4);
      border-radius: 4px;
      color: rgba(100, 149, 237, 0.7);
      font-size: 12px;
      cursor: pointer;
      transition: all 0.2s;
    }

    #orbit-toggle:hover {
      background: rgba(100, 149, 237, 0.25);
      border-color: rgba(100, 149, 237, 0.6);
      color: #6495ED;
    }

    #orbit-toggle.active {
      background: rgba(100, 149, 237, 0.3);
      border-color: #6495ED;
      color: #6495ED;
      animation: orbit-pulse 2s ease-in-out infinite;
    }

    @keyframes orbit-pulse {
      0%, 100% { box-shadow: 0 0 0 0 rgba(100, 149, 237, 0.4); }
      50% { box-shadow: 0 0 0 4px rgba(100, 149, 237, 0.2); }
    }

    #orbit-toggle .orbit-icon {
      font-size: 14px;
    }

    /* Orbit Speed Slider */
    #orbit-speed-container {
      display: flex;
      align-items: center;
      gap: 6px;
      margin-left: 8px;
      padding: 4px 8px;
      background: rgba(100, 149, 237, 0.1);
      border-radius: 4px;
    }

    #orbit-speed-label {
      font-size: 11px;
      color: rgba(100, 149, 237, 0.7);
    }

    #orbit-speed-slider {
      width: 60px;
      height: 4px;
      -webkit-appearance: none;
      background: rgba(100, 149, 237, 0.3);
      border-radius: 2px;
      outline: none;
    }

    #orbit-speed-slider::-webkit-slider-thumb {
      -webkit-appearance: none;
      width: 12px;
      height: 12px;
      background: #6495ED;
      border-radius: 50%;
      cursor: pointer;
    }

    #orbit-speed-slider::-webkit-slider-thumb:hover {
      background: #87CEEB;
    }

    #orbit-speed-value {
      font-size: 11px;
      color: rgba(100, 149, 237, 0.7);
      min-width: 20px;
    }

    /* Navigation History Controls */
    #nav-controls {
      display: flex;
      align-items: center;
      gap: 4px;
      margin-left: 12px;
      padding-left: 12px;
      border-left: 1px solid rgba(255, 255, 255, 0.15);
    }

    .nav-btn {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 26px;
      height: 24px;
      background: rgba(78, 205, 196, 0.15);
      border: 1px solid rgba(78, 205, 196, 0.3);
      border-radius: 3px;
      color: rgba(78, 205, 196, 0.8);
      font-size: 10px;
      cursor: pointer;
      transition: all 0.2s;
    }

    .nav-btn:hover:not(.disabled) {
      background: rgba(78, 205, 196, 0.3);
      border-color: rgba(78, 205, 196, 0.6);
      color: #4ECDC4;
    }

    .nav-btn:active:not(.disabled) {
      background: rgba(78, 205, 196, 0.4);
      transform: scale(0.95);
    }

    .nav-btn.disabled {
      opacity: 0.35;
      cursor: not-allowed;
    }

    .nav-btn span {
      font-size: 12px;
    }

    #recent-nodes {
      height: 24px;
      padding: 0 8px;
      background: rgba(42, 42, 78, 0.8);
      border: 1px solid rgba(78, 205, 196, 0.3);
      border-radius: 3px;
      color: #ccc;
      font-size: 11px;
      cursor: pointer;
      min-width: 120px;
      max-width: 160px;
    }

    #recent-nodes:hover {
      border-color: rgba(78, 205, 196, 0.5);
    }

    #recent-nodes:focus {
      outline: none;
      border-color: #4ECDC4;
    }

    #recent-nodes option {
      background: #2a2a4e;
      color: #eee;
      padding: 4px;
    }

    /* Breadcrumb Trail */
    #breadcrumb-trail {
      position: relative;
      display: flex;
      align-items: center;
      gap: 4px;
      font-size: 12px;
      color: #888;
      max-width: 400px;
      overflow: hidden;
      margin-left: 8px;
      padding-left: 8px;
      white-space: nowrap;
    }

    .breadcrumb-segment {
      color: #4ECDC4;
      cursor: pointer;
      white-space: nowrap;
      transition: color 0.2s;
    }

    .breadcrumb-segment:hover {
      color: #45B7D1;
      text-decoration: underline;
    }

    .breadcrumb-segment.current {
      color: #fff;
      cursor: default;
    }

    .breadcrumb-segment.current:hover {
      text-decoration: none;
    }

    .breadcrumb-separator {
      color: #555;
      font-size: 10px;
      margin: 0 2px;
    }

    /* When breadcrumb overflows, fade left edge */
    #breadcrumb-trail::before {
      content: '';
      position: absolute;
      left: 0;
      top: 0;
      bottom: 0;
      width: 20px;
      background: linear-gradient(to right, rgba(26, 26, 46, 0.95), transparent);
      pointer-events: none;
      opacity: 0;
      transition: opacity 0.2s;
    }

    #breadcrumb-trail.overflow::before {
      opacity: 1;
    }

    /* Heat Decay Slider */
    #heat-decay-container {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-left: 15px;
      padding-left: 15px;
      border-left: 1px solid rgba(255,255,255,0.2);
    }

    #heat-decay-label {
      font-size: 12px;
      color: rgba(255,255,255,0.8);
      white-space: nowrap;
    }

    #heat-decay-slider {
      width: 100px;
      height: 4px;
      -webkit-appearance: none;
      background: rgba(255,255,255,0.2);
      border-radius: 2px;
      outline: none;
      cursor: pointer;
    }

    #heat-decay-slider::-webkit-slider-thumb {
      -webkit-appearance: none;
      width: 14px;
      height: 14px;
      background: #FF6B6B;
      border-radius: 50%;
      cursor: pointer;
      transition: background 0.2s;
    }

    #heat-decay-slider::-webkit-slider-thumb:hover {
      background: #FF8C00;
    }

    #heat-decay-value {
      font-size: 11px;
      color: rgba(255,255,255,0.6);
      min-width: 35px;
    }

    /* Flash Duration Slider */
    #flash-duration-container {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-left: 15px;
      padding-left: 15px;
      border-left: 1px solid rgba(255,255,255,0.2);
    }

    #flash-duration-label {
      font-size: 12px;
      color: rgba(255,255,255,0.8);
      white-space: nowrap;
    }

    #flash-duration-slider {
      width: 80px;
      height: 4px;
      -webkit-appearance: none;
      background: rgba(255,255,255,0.2);
      border-radius: 2px;
      outline: none;
      cursor: pointer;
    }

    #flash-duration-slider::-webkit-slider-thumb {
      -webkit-appearance: none;
      width: 14px;
      height: 14px;
      background: #4ECDC4;
      border-radius: 50%;
      cursor: pointer;
      transition: background 0.2s;
    }

    #flash-duration-slider::-webkit-slider-thumb:hover {
      background: #5ddfd6;
    }

    #flash-duration-value {
      font-size: 11px;
      color: rgba(255,255,255,0.6);
      min-width: 25px;
    }

    /* Flash Intensity Slider */
    #flash-intensity-container {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-left: 10px;
    }

    #flash-intensity-label {
      font-size: 12px;
      color: rgba(255,255,255,0.8);
      white-space: nowrap;
    }

    #flash-intensity-slider {
      width: 80px;
      height: 4px;
      -webkit-appearance: none;
      background: rgba(255,255,255,0.2);
      border-radius: 2px;
      outline: none;
      cursor: pointer;
    }

    #flash-intensity-slider::-webkit-slider-thumb {
      -webkit-appearance: none;
      width: 14px;
      height: 14px;
      background: #4ECDC4;
      border-radius: 50%;
      cursor: pointer;
      transition: background 0.2s;
    }

    #flash-intensity-slider::-webkit-slider-thumb:hover {
      background: #5ddfd6;
    }

    #flash-intensity-value {
      font-size: 11px;
      color: rgba(255,255,255,0.6);
      min-width: 25px;
    }

    /* Follow-Active Toggle */
    #follow-toggle {
      display: flex;
      align-items: center;
      gap: 6px;
      padding: 6px 12px;
      margin-left: 10px;
      background: rgba(255, 165, 0, 0.15);
      border: 1px solid rgba(255, 165, 0, 0.4);
      border-radius: 4px;
      color: rgba(255, 165, 0, 0.7);
      font-size: 12px;
      cursor: pointer;
      transition: all 0.2s;
    }

    #follow-toggle:hover {
      background: rgba(255, 165, 0, 0.25);
      border-color: rgba(255, 165, 0, 0.6);
      color: #FFA500;
    }

    #follow-toggle.active {
      background: rgba(255, 165, 0, 0.3);
      border-color: #FFA500;
      color: #FFA500;
    }

    #follow-toggle .follow-icon {
      font-size: 14px;
    }

    /* Trails Toggle Button */
    #trails-toggle {
      display: flex;
      align-items: center;
      gap: 6px;
      padding: 6px 12px;
      margin-left: 10px;
      background: rgba(78, 205, 196, 0.2);
      border: 1px solid rgba(78, 205, 196, 0.5);
      border-radius: 4px;
      font-size: 12px;
      color: rgba(78, 205, 196, 0.7);
      cursor: pointer;
      transition: all 0.2s;
    }

    #trails-toggle:hover {
      background: rgba(78, 205, 196, 0.3);
      border-color: rgba(78, 205, 196, 0.7);
      color: #4ECDC4;
    }

    #trails-toggle.active {
      background: rgba(78, 205, 196, 0.3);
      border-color: #4ECDC4;
      color: #4ECDC4;
    }

    #trails-toggle .trails-icon {
      font-size: 14px;
    }

    /* Trail Duration Slider */
    #trail-duration-container {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-left: 10px;
    }

    #trail-duration-label {
      font-size: 12px;
      color: rgba(255,255,255,0.8);
      white-space: nowrap;
    }

    #trail-duration-slider {
      width: 80px;
      height: 4px;
      -webkit-appearance: none;
      background: rgba(255,255,255,0.2);
      border-radius: 2px;
      outline: none;
      cursor: pointer;
    }

    #trail-duration-slider::-webkit-slider-thumb {
      -webkit-appearance: none;
      width: 14px;
      height: 14px;
      background: #4ECDC4;
      border-radius: 50%;
      cursor: pointer;
      transition: background 0.2s;
    }

    #trail-duration-slider::-webkit-slider-thumb:hover {
      background: #5ddfd6;
    }

    #trail-duration-value {
      font-size: 11px;
      color: rgba(255,255,255,0.6);
      min-width: 30px;
    }

    /* Git Branch Display */
    #branch-display {
      display: flex;
      align-items: center;
      gap: 6px;
      padding: 4px 10px;
      background: rgba(46, 204, 113, 0.15);
      border: 1px solid rgba(46, 204, 113, 0.4);
      border-radius: 4px;
      font-size: 12px;
      color: #2ECC71;
    }

    #branch-display .branch-icon {
      font-size: 14px;
    }

    #branch-name {
      max-width: 150px;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }

    #branch-display.no-branch {
      opacity: 0.5;
      color: #888;
      background: rgba(128, 128, 128, 0.15);
      border-color: rgba(128, 128, 128, 0.4);
    }

    /* Statistics Toggle Button */
    #statistics-toggle {
      position: fixed;
      right: 10px;
      bottom: 10px;
      background: rgba(78, 205, 196, 0.9);
      color: #1a1a2e;
      border: none;
      padding: 6px 12px;
      border-radius: 4px;
      cursor: pointer;
      font-size: 12px;
      font-weight: 500;
      z-index: 95;
      transition: right 0.3s ease, background 0.2s;
    }

    #statistics-toggle:hover {
      background: #45B7D1;
    }

    #statistics-toggle.panel-open {
      right: 330px;
    }

    /* Statistics Panel */
    #statistics-panel {
      position: fixed;
      right: 0;
      top: 50px;
      width: 320px;
      height: calc(100% - 50px);
      background: rgba(26, 26, 46, 0.98);
      border-left: 1px solid #333;
      z-index: 90;
      transform: translateX(100%);
      transition: transform 0.3s ease;
      display: flex;
      flex-direction: column;
      overflow: hidden;
    }

    #statistics-panel.visible {
      transform: translateX(0);
    }

    #statistics-panel .panel-header {
      padding: 12px 16px;
      border-bottom: 1px solid #333;
      display: flex;
      align-items: center;
      justify-content: space-between;
      flex-shrink: 0;
    }

    #statistics-panel .panel-header span {
      font-size: 14px;
      font-weight: 500;
      color: #4ECDC4;
    }

    #stats-refresh {
      background: transparent;
      border: 1px solid #555;
      color: #888;
      padding: 4px 10px;
      border-radius: 3px;
      cursor: pointer;
      font-size: 14px;
      transition: all 0.2s;
    }

    #stats-refresh:hover {
      border-color: #4ECDC4;
      color: #4ECDC4;
    }

    #stats-content {
      flex: 1;
      overflow-y: auto;
      padding: 12px 16px;
    }

    .stats-section {
      margin-bottom: 20px;
    }

    .stats-section h4 {
      font-size: 12px;
      font-weight: 600;
      color: #888;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      margin-bottom: 10px;
    }

    /* File Ranking Styles */
    #stats-file-ranking {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .ranking-entry {
      display: flex;
      flex-direction: column;
      gap: 4px;
      cursor: pointer;
      padding: 8px;
      border-radius: 4px;
      transition: background 0.15s;
    }

    .ranking-entry:hover {
      background: rgba(78, 205, 196, 0.15);
    }

    .ranking-entry .ranking-path {
      font-size: 12px;
      color: #ccc;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .ranking-entry .ranking-bar-container {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .ranking-entry .ranking-bar {
      flex: 1;
      height: 6px;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 3px;
      overflow: hidden;
    }

    .ranking-entry .ranking-bar-fill {
      height: 100%;
      border-radius: 3px;
      transition: width 0.3s ease;
    }

    .ranking-entry .ranking-count {
      font-size: 11px;
      font-weight: 600;
      color: #888;
      min-width: 30px;
      text-align: right;
    }

    /* Bar fill colors by dominant event type */
    .ranking-bar-fill.created { background: #2ECC71; }
    .ranking-bar-fill.modified { background: #F39C12; }
    .ranking-bar-fill.deleted { background: #E74C3C; }

    /* Stats empty state */
    .stats-empty {
      padding: 20px;
      text-align: center;
      color: #666;
      font-size: 12px;
      font-style: italic;
    }

    /* Activity Chart Styles */
    .activity-chart {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .chart-bars {
      display: flex;
      align-items: flex-end;
      height: 150px;
      gap: 2px;
      padding: 0 4px;
    }

    .chart-bar {
      flex: 1;
      min-width: 8px;
      background: linear-gradient(to top, #4ECDC4, #45B7D1);
      border-radius: 2px 2px 0 0;
      position: relative;
      cursor: pointer;
      transition: height 0.3s ease, opacity 0.2s;
    }

    .chart-bar:hover {
      opacity: 0.8;
    }

    .chart-bar .bar-value {
      position: absolute;
      top: -18px;
      left: 50%;
      transform: translateX(-50%);
      font-size: 10px;
      color: #888;
      display: none;
    }

    .chart-bar:hover .bar-value {
      display: block;
    }

    .chart-axis {
      display: flex;
      justify-content: space-between;
      padding: 4px 4px 0;
      border-top: 1px solid rgba(255, 255, 255, 0.1);
    }

    .chart-axis span {
      font-size: 10px;
      color: #666;
    }

    /* Adjust graph container when statistics panel is open */
    #graph-container.statistics-open {
      right: 320px;
      width: calc(100% - 320px);
    }

    /* Adjust when both tree and statistics are open */
    #graph-container.tree-open.statistics-open {
      width: calc(100% - 280px - 320px);
    }

    /* Custom scrollbar for stats content */
    #stats-content::-webkit-scrollbar {
      width: 6px;
    }

    #stats-content::-webkit-scrollbar-track {
      background: rgba(0, 0, 0, 0.2);
    }

    #stats-content::-webkit-scrollbar-thumb {
      background: #4ECDC4;
      border-radius: 3px;
    }

    #stats-content::-webkit-scrollbar-thumb:hover {
      background: #45B7D1;
    }

    /* File Inspector Modal */
    #file-inspector-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.7);
      z-index: 500;
      opacity: 0;
      transition: opacity 0.2s ease;
    }

    #file-inspector-overlay.visible {
      opacity: 1;
    }

    #file-inspector-overlay.hidden {
      display: none;
    }

    #file-inspector-modal {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 80%;
      max-width: 900px;
      max-height: 80vh;
      background: #1e1e2e;
      border: 1px solid #4ECDC4;
      border-radius: 8px;
      z-index: 501;
      display: flex;
      flex-direction: column;
      box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
    }

    #file-inspector-modal.hidden {
      display: none;
    }

    #file-inspector-modal .modal-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 16px 20px;
      border-bottom: 1px solid #333;
      background: rgba(26, 26, 46, 0.98);
      border-radius: 8px 8px 0 0;
    }

    #file-inspector-modal .modal-header h2 {
      margin: 0;
      font-size: 16px;
      color: #4ECDC4;
      font-weight: 500;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }

    #inspector-close {
      background: none;
      border: none;
      color: #888;
      font-size: 24px;
      cursor: pointer;
      padding: 0;
      line-height: 1;
      transition: color 0.2s;
    }

    #inspector-close:hover {
      color: #fff;
    }

    #file-inspector-modal .modal-body {
      flex: 1;
      overflow-y: auto;
      padding: 16px 20px;
    }

    /* Collapsible Sections */
    .collapsible-section {
      margin-bottom: 12px;
      border: 1px solid #333;
      border-radius: 6px;
      overflow: hidden;
    }

    .collapsible-section:last-child {
      margin-bottom: 0;
    }

    .section-header {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 12px 16px;
      background: #2a2a4e;
      cursor: pointer;
      user-select: none;
      transition: background 0.2s;
    }

    .section-header:hover {
      background: #353560;
    }

    .section-toggle {
      color: #4ECDC4;
      font-size: 10px;
      transition: transform 0.2s;
    }

    .collapsible-section.collapsed .section-toggle {
      transform: rotate(-90deg);
    }

    .section-title {
      font-size: 14px;
      font-weight: 500;
      color: #eee;
    }

    .section-content {
      padding: 16px;
      background: #1e1e2e;
      max-height: 400px;
      overflow-y: auto;
    }

    .collapsible-section.collapsed .section-content {
      display: none;
    }

    .section-placeholder {
      color: #666;
      font-style: italic;
      text-align: center;
      padding: 20px;
      margin: 0;
    }

    /* Modal body scrollbar */
    #file-inspector-modal .modal-body::-webkit-scrollbar {
      width: 8px;
    }

    #file-inspector-modal .modal-body::-webkit-scrollbar-track {
      background: rgba(0, 0, 0, 0.2);
    }

    #file-inspector-modal .modal-body::-webkit-scrollbar-thumb {
      background: #4ECDC4;
      border-radius: 4px;
    }

    #file-inspector-modal .modal-body::-webkit-scrollbar-thumb:hover {
      background: #45B7D1;
    }

    /* Section content scrollbar */
    .section-content::-webkit-scrollbar {
      width: 6px;
    }

    .section-content::-webkit-scrollbar-track {
      background: rgba(0, 0, 0, 0.2);
    }

    .section-content::-webkit-scrollbar-thumb {
      background: #4ECDC4;
      border-radius: 3px;
    }

    /* Diff mode toggle */
    .diff-mode-toggle {
      display: flex;
      gap: 4px;
      margin-left: auto;
    }
    .mode-btn {
      padding: 4px 10px;
      border: 1px solid #555;
      background: transparent;
      color: #888;
      font-size: 11px;
      cursor: pointer;
      border-radius: 3px;
      transition: all 0.2s;
    }
    .mode-btn:hover {
      border-color: #4ECDC4;
      color: #ccc;
    }
    .mode-btn.active {
      background: #4ECDC4;
      border-color: #4ECDC4;
      color: #1a1a2e;
    }

    /* Line numbers in diff view */
    .diff-line-container {
      display: flex;
    }
    .diff-line-number {
      min-width: 40px;
      padding: 2px 8px;
      text-align: right;
      color: #555;
      background: rgba(0,0,0,0.2);
      border-right: 1px solid #333;
      user-select: none;
      cursor: pointer;
      font-size: 11px;
      font-family: 'Consolas', 'Monaco', monospace;
    }
    .diff-line-number:hover {
      color: #4ECDC4;
      background: rgba(78, 205, 196, 0.1);
    }
    .diff-line-content {
      flex: 1;
      padding: 2px 8px;
      white-space: pre-wrap;
      word-break: break-all;
    }

    /* Basic syntax highlighting */
    .syntax-keyword { color: #C678DD; }
    .syntax-string { color: #98C379; }
    .syntax-comment { color: #5C6370; font-style: italic; }
    .syntax-number { color: #D19A66; }
    .syntax-function { color: #61AFEF; }

    /* Structure Tree Styles */
    .structure-tree {
      font-family: 'Consolas', 'Monaco', monospace;
      font-size: 12px;
    }

    .structure-item {
      display: flex;
      align-items: center;
      padding: 4px 8px;
      cursor: pointer;
      transition: background 0.15s;
      border-radius: 3px;
    }

    .structure-item:hover {
      background: rgba(78, 205, 196, 0.15);
    }

    .structure-item.active {
      background: rgba(78, 205, 196, 0.25);
      border-left: 2px solid #4ECDC4;
    }

    .structure-toggle {
      width: 16px;
      height: 16px;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      margin-right: 4px;
      color: #888;
      font-size: 8px;
      transition: transform 0.2s;
      flex-shrink: 0;
    }

    .structure-toggle.expanded {
      transform: rotate(90deg);
    }

    .structure-toggle.no-children {
      visibility: hidden;
    }

    .structure-icon {
      margin-right: 6px;
      font-size: 12px;
      flex-shrink: 0;
    }

    .structure-icon.header { color: #4ECDC4; }
    .structure-icon.function { color: #61AFEF; }
    .structure-icon.class { color: #E5C07B; }
    .structure-icon.import { color: #C678DD; }
    .structure-icon.export { color: #98C379; }
    .structure-icon.key { color: #D19A66; }
    .structure-icon.list { color: #ABB2BF; }
    .structure-icon.codeblock { color: #56B6C2; }

    .structure-name {
      flex: 1;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
      color: #ccc;
    }

    .structure-line {
      margin-left: 8px;
      font-size: 10px;
      color: #666;
    }

    .structure-children {
      display: none;
      margin-left: 16px;
    }

    .structure-children.expanded {
      display: block;
    }

    .structure-empty {
      padding: 20px;
      text-align: center;
      color: #666;
      font-style: italic;
    }

    /* Context Section - Metadata Header and Quick Actions */
    .metadata-header {
      display: grid;
      grid-template-columns: auto 1fr;
      gap: 8px 16px;
      padding: 12px;
      border-bottom: 1px solid #333;
      background: rgba(42, 42, 78, 0.3);
    }

    .metadata-label {
      color: #888;
      font-size: 11px;
      text-transform: uppercase;
      font-weight: 600;
      letter-spacing: 0.5px;
    }

    .metadata-value {
      color: #ccc;
      font-size: 13px;
    }

    .git-status-badge {
      display: inline-block;
      padding: 2px 8px;
      border-radius: 3px;
      font-size: 11px;
      font-weight: 600;
    }

    .git-status-badge.staged {
      background: rgba(46, 204, 113, 0.2);
      color: #2ECC71;
    }

    .git-status-badge.modified {
      background: rgba(243, 156, 18, 0.2);
      color: #F39C12;
    }

    .git-status-badge.untracked {
      background: rgba(155, 89, 182, 0.2);
      color: #9B59B6;
    }

    .git-status-badge.clean {
      background: rgba(136, 136, 136, 0.2);
      color: #888;
    }

    .quick-actions {
      display: flex;
      gap: 8px;
      padding: 12px;
      border-bottom: 1px solid #333;
      background: rgba(26, 26, 46, 0.3);
    }

    .quick-action-btn {
      flex: 1;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
      height: 32px;
      padding: 0 10px;
      border: none;
      border-radius: 4px;
      font-size: 12px;
      cursor: pointer;
      transition: all 0.2s;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
    }

    .quick-action-btn.primary {
      background: #4ECDC4;
      color: #1a1a2e;
      font-weight: 600;
    }

    .quick-action-btn.primary:hover {
      background: #5ddfd6;
      transform: translateY(-1px);
      box-shadow: 0 2px 8px rgba(78, 205, 196, 0.3);
    }

    .quick-action-btn.secondary {
      background: rgba(136, 136, 136, 0.2);
      color: #ccc;
      border: 1px solid #555;
    }

    .quick-action-btn.secondary:hover {
      background: rgba(136, 136, 136, 0.3);
      border-color: #888;
      color: #fff;
    }

    .quick-action-btn .icon {
      font-size: 14px;
    }

    .context-loading {
      padding: 20px;
      text-align: center;
      color: #666;
      font-style: italic;
    }

    .context-error {
      padding: 20px;
      text-align: center;
      color: #E74C3C;
      font-style: italic;
    }

    /* Toast notification */
    .toast {
      position: fixed;
      bottom: 30px;
      left: 50%;
      transform: translateX(-50%);
      background: rgba(78, 205, 196, 0.95);
      color: #1a1a2e;
      padding: 12px 24px;
      border-radius: 6px;
      font-size: 13px;
      font-weight: 600;
      z-index: 1002;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    .toast.visible {
      opacity: 1;
    }

    .toast.error {
      background: rgba(231, 76, 60, 0.95);
      color: #fff;
    }

    /* Context Section - Recent Activity and Related Files */
    .context-subsection {
      margin-top: 20px;
    }

    .context-subsection-title {
      font-size: 12px;
      color: #888;
      text-transform: uppercase;
      margin-bottom: 10px;
      font-weight: 600;
      letter-spacing: 0.5px;
      padding: 0 12px;
    }

    .activity-list {
      display: flex;
      flex-direction: column;
      gap: 8px;
      max-height: 200px;
      overflow-y: auto;
      padding: 0 12px;
    }

    .activity-item {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 8px;
      border-left: 3px solid transparent;
      border-radius: 3px;
      transition: background 0.15s;
      cursor: pointer;
    }

    .activity-item.created {
      border-left-color: #2ECC71;
    }

    .activity-item.modified {
      border-left-color: #F39C12;
    }

    .activity-item.deleted {
      border-left-color: #E74C3C;
    }

    .activity-item:hover {
      background: rgba(78, 205, 196, 0.1);
    }

    .activity-item.created:hover {
      background: rgba(46, 204, 113, 0.1);
    }

    .activity-item.modified:hover {
      background: rgba(243, 156, 18, 0.1);
    }

    .activity-item.deleted:hover {
      background: rgba(231, 76, 60, 0.1);
    }

    .activity-timestamp {
      color: #666;
      font-size: 11px;
      margin-left: auto;
      flex-shrink: 0;
    }

    .activity-type-badge {
      padding: 2px 6px;
      border-radius: 3px;
      font-size: 10px;
      font-weight: 500;
      text-transform: capitalize;
    }

    .activity-item.created .activity-type-badge {
      background: rgba(46, 204, 113, 0.2);
      color: #2ECC71;
    }

    .activity-item.modified .activity-type-badge {
      background: rgba(243, 156, 18, 0.2);
      color: #F39C12;
    }

    .activity-item.deleted .activity-type-badge {
      background: rgba(231, 76, 60, 0.2);
      color: #E74C3C;
    }

    .related-files-list {
      display: flex;
      flex-direction: column;
      gap: 6px;
      padding: 0 12px;
    }

    .related-file-item {
      display: flex;
      align-items: center;
      padding: 6px 8px;
      border-radius: 3px;
      transition: background 0.15s;
      cursor: pointer;
    }

    .related-file-item:hover {
      background: rgba(78, 205, 196, 0.15);
    }

    .related-file-icon {
      margin-right: 8px;
      color: #888;
      font-size: 14px;
      flex-shrink: 0;
    }

    .related-file-path {
      color: #ccc;
      font-size: 12px;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
      flex: 1;
    }

    .context-empty {
      padding: 16px;
      text-align: center;
      color: #666;
      font-style: italic;
      font-size: 12px;
    }

    /* Match scrollbar styles from modal */
    .activity-list::-webkit-scrollbar {
      width: 6px;
    }

    .activity-list::-webkit-scrollbar-track {
      background: rgba(0, 0, 0, 0.2);
    }

    .activity-list::-webkit-scrollbar-thumb {
      background: #4ECDC4;
      border-radius: 3px;
    }

    /* Modal Search Styles */
    #modal-search-container {
      display: flex;
      align-items: center;
      gap: 8px;
      flex: 1;
      max-width: 400px;
      margin: 0 16px;
    }

    #modal-search-container.hidden {
      display: none;
    }

    #modal-search-input {
      flex: 1;
      height: 28px;
      padding: 0 8px;
      background: #2a2a4e;
      border: 1px solid #555;
      border-radius: 4px;
      color: #eee;
      font-size: 12px;
      outline: none;
    }

    #modal-search-input:focus {
      border-color: #4ECDC4;
      box-shadow: 0 0 0 2px rgba(78, 205, 196, 0.2);
    }

    #modal-search-info {
      font-size: 11px;
      color: #888;
      min-width: 60px;
      text-align: center;
    }

    #modal-search-nav {
      display: flex;
      gap: 2px;
    }

    #modal-search-nav button,
    #search-close {
      width: 24px;
      height: 24px;
      padding: 0;
      background: transparent;
      border: 1px solid #555;
      border-radius: 3px;
      color: #888;
      font-size: 12px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.2s;
    }

    #modal-search-nav button:hover,
    #search-close:hover {
      border-color: #4ECDC4;
      color: #4ECDC4;
      background: rgba(78, 205, 196, 0.1);
    }

    #modal-search-nav button:disabled {
      opacity: 0.3;
      cursor: not-allowed;
    }

    /* Search match highlighting */
    mark.search-match {
      background: rgba(243, 156, 18, 0.4);
      color: inherit;
      padding: 2px 0;
      border-radius: 2px;
    }

    mark.search-match.current {
      background: rgba(78, 205, 196, 0.6);
      box-shadow: 0 0 0 2px rgba(78, 205, 196, 0.3);
    }

    /* Path Playback Button */
    #path-play {
      display: flex;
      align-items: center;
      gap: 6px;
      padding: 6px 12px;
      margin-left: 8px;
      background: rgba(100, 149, 237, 0.15);
      border: 1px solid rgba(100, 149, 237, 0.4);
      border-radius: 4px;
      color: rgba(100, 149, 237, 0.7);
      font-size: 12px;
      cursor: pointer;
      transition: all 0.2s;
    }

    #path-play:hover {
      background: rgba(100, 149, 237, 0.25);
      border-color: rgba(100, 149, 237, 0.6);
      color: #6495ED;
    }

    #path-play.active {
      background: rgba(100, 149, 237, 0.3);
      border-color: #6495ED;
      color: #6495ED;
    }

    #path-play .path-icon {
      font-size: 12px;
    }

    /* Path Progress Indicator */
    #path-progress {
      display: none;
      margin-left: 6px;
      padding: 2px 8px;
      background: rgba(100, 149, 237, 0.2);
      border-radius: 10px;
      font-size: 11px;
      color: #6495ED;
      font-weight: 500;
    }

    /* Bookmark Button */
    #bookmark-btn {
      display: flex;
      align-items: center;
      gap: 4px;
      padding: 6px 10px;
      margin-left: 12px;
      background: rgba(255, 215, 0, 0.15);
      border: 1px solid rgba(255, 215, 0, 0.4);
      border-radius: 4px;
      color: rgba(255, 215, 0, 0.8);
      font-size: 12px;
      cursor: pointer;
      transition: all 0.2s;
    }

    #bookmark-btn:hover {
      background: rgba(255, 215, 0, 0.25);
      border-color: rgba(255, 215, 0, 0.6);
      color: #FFD700;
    }

    #bookmark-btn .bookmark-icon {
      font-size: 14px;
    }

    #bookmark-btn .bookmark-count {
      display: none;
      background: rgba(255, 215, 0, 0.3);
      color: #FFD700;
      font-size: 10px;
      font-weight: bold;
      padding: 1px 5px;
      border-radius: 8px;
      min-width: 16px;
      text-align: center;
    }

    /* Bookmark Dialog */
    #bookmark-dialog-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.6);
      z-index: 600;
    }

    #bookmark-dialog-overlay.hidden,
    #bookmark-dialog.hidden {
      display: none;
    }

    #bookmark-dialog-overlay.visible,
    #bookmark-dialog.visible {
      display: block;
    }

    #bookmark-dialog {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 360px;
      background: #1e1e2e;
      border: 1px solid #FFD700;
      border-radius: 8px;
      z-index: 601;
      box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
    }

    #bookmark-dialog .dialog-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 12px 16px;
      border-bottom: 1px solid #333;
      background: rgba(255, 215, 0, 0.1);
      border-radius: 8px 8px 0 0;
    }

    #bookmark-dialog .dialog-header h3 {
      margin: 0;
      font-size: 14px;
      color: #FFD700;
    }

    #bookmark-dialog-close {
      background: none;
      border: none;
      color: #888;
      font-size: 20px;
      cursor: pointer;
      padding: 0;
      line-height: 1;
    }

    #bookmark-dialog-close:hover {
      color: #fff;
    }

    #bookmark-dialog .dialog-body {
      padding: 16px;
    }

    #bookmark-dialog .dialog-field {
      margin-bottom: 16px;
    }

    #bookmark-dialog .dialog-field label {
      display: block;
      margin-bottom: 6px;
      font-size: 12px;
      color: #888;
      text-transform: uppercase;
    }

    #bookmark-name {
      width: 100%;
      height: 32px;
      padding: 0 10px;
      background: #2a2a4e;
      border: 1px solid #555;
      border-radius: 4px;
      color: #eee;
      font-size: 13px;
    }

    #bookmark-name:focus {
      outline: none;
      border-color: #FFD700;
    }

    .bookmark-slots {
      display: grid;
      grid-template-columns: repeat(5, 1fr);
      gap: 6px;
    }

    .bookmark-slot {
      display: flex;
      align-items: center;
      justify-content: center;
      height: 36px;
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid #444;
      border-radius: 4px;
      cursor: pointer;
      transition: all 0.2s;
      position: relative;
    }

    .bookmark-slot:hover {
      background: rgba(255, 215, 0, 0.15);
      border-color: rgba(255, 215, 0, 0.5);
    }

    .bookmark-slot.selected {
      background: rgba(255, 215, 0, 0.25);
      border-color: #FFD700;
    }

    .bookmark-slot.occupied {
      background: rgba(78, 205, 196, 0.15);
      border-color: rgba(78, 205, 196, 0.4);
    }

    .bookmark-slot.occupied:hover {
      border-color: rgba(255, 215, 0, 0.5);
    }

    .bookmark-slot .slot-number {
      font-size: 14px;
      font-weight: bold;
      color: #888;
    }

    .bookmark-slot.selected .slot-number,
    .bookmark-slot.occupied .slot-number {
      color: #FFD700;
    }

    .bookmark-slot .slot-indicator {
      position: absolute;
      top: 2px;
      right: 2px;
      width: 6px;
      height: 6px;
      background: #4ECDC4;
      border-radius: 50%;
      display: none;
    }

    .bookmark-slot.occupied .slot-indicator {
      display: block;
    }

    .dialog-info {
      font-size: 11px;
      color: #666;
      font-style: italic;
    }

    #bookmark-dialog .dialog-footer {
      display: flex;
      gap: 8px;
      padding: 12px 16px;
      border-top: 1px solid #333;
      justify-content: flex-end;
    }

    #bookmark-dialog .dialog-footer button {
      padding: 8px 16px;
      border-radius: 4px;
      font-size: 12px;
      cursor: pointer;
      transition: all 0.2s;
    }

    #bookmark-dialog .dialog-footer button.primary {
      background: #FFD700;
      border: none;
      color: #1a1a2e;
      font-weight: 600;
    }

    #bookmark-dialog .dialog-footer button.primary:hover {
      background: #FFED4A;
    }

    #bookmark-dialog .dialog-footer button.secondary {
      background: transparent;
      border: 1px solid #555;
      color: #888;
    }

    #bookmark-dialog .dialog-footer button.secondary:hover {
      border-color: #888;
      color: #ccc;
    }

    /* Bookmark List */
    .bookmark-list-section {
      margin-top: 16px;
      padding-top: 12px;
      border-top: 1px solid #333;
    }

    .bookmark-list-section label {
      display: block;
      margin-bottom: 8px;
      font-size: 12px;
      color: #888;
      text-transform: uppercase;
    }

    #bookmark-list {
      max-height: 150px;
      overflow-y: auto;
    }

    .bookmark-list-item {
      display: flex;
      align-items: center;
      padding: 8px;
      margin-bottom: 4px;
      background: rgba(255, 255, 255, 0.03);
      border-radius: 4px;
      transition: background 0.15s;
    }

    .bookmark-list-item:hover {
      background: rgba(255, 255, 255, 0.08);
    }

    .bookmark-list-item .bm-slot {
      width: 24px;
      height: 24px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: rgba(255, 215, 0, 0.2);
      border-radius: 4px;
      font-size: 12px;
      font-weight: bold;
      color: #FFD700;
      margin-right: 10px;
      flex-shrink: 0;
    }

    .bookmark-list-item .bm-name {
      flex: 1;
      font-size: 12px;
      color: #ccc;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }

    .bookmark-list-item .bm-go {
      padding: 4px 8px;
      margin-right: 6px;
      background: rgba(78, 205, 196, 0.2);
      border: 1px solid rgba(78, 205, 196, 0.4);
      border-radius: 3px;
      color: #4ECDC4;
      font-size: 10px;
      cursor: pointer;
      transition: all 0.2s;
    }

    .bookmark-list-item .bm-go:hover {
      background: rgba(78, 205, 196, 0.4);
      color: #fff;
    }

    .bookmark-list-item .bm-delete {
      padding: 4px 8px;
      background: transparent;
      border: 1px solid rgba(231, 76, 60, 0.4);
      border-radius: 3px;
      color: rgba(231, 76, 60, 0.7);
      font-size: 10px;
      cursor: pointer;
      transition: all 0.2s;
    }

    .bookmark-list-item .bm-delete:hover {
      background: rgba(231, 76, 60, 0.2);
      border-color: #E74C3C;
      color: #E74C3C;
    }

    .bookmark-empty {
      color: #555;
      font-size: 11px;
      font-style: italic;
      text-align: center;
      padding: 12px;
    }

    /* Scrollbar for bookmark list */
    #bookmark-list::-webkit-scrollbar {
      width: 6px;
    }

    #bookmark-list::-webkit-scrollbar-track {
      background: rgba(0, 0, 0, 0.2);
    }

    #bookmark-list::-webkit-scrollbar-thumb {
      background: #FFD700;
      border-radius: 3px;
    }
  </style>
</head>
<body>
  <div id="toolbar">
    <button id="select-folder-btn">Select Project</button>
    <select id="recent-projects">
      <option value="">Recent Projects...</option>
    </select>
    <button id="refresh-btn" title="Refresh graph"> Refresh</button>
    <button id="dimension-toggle" title="Toggle between 2D and 3D view">3D</button>
    <div id="zoom-presets" title="Quick zoom presets">
      <button id="zoom-overview" class="zoom-btn" title="Zoom out to see entire graph">
        <span>&#128269;-</span>
      </button>
      <button id="zoom-focus" class="zoom-btn" title="Focus on selected node (medium distance)">
        <span>&#9678;</span>
      </button>
      <button id="zoom-detail" class="zoom-btn" title="Detail view of selected node (close-up)">
        <span>&#128269;+</span>
      </button>
    </div>
    <button id="orbit-toggle" title="Orbit camera around selected node (presentation mode)">
      <span class="orbit-icon">&#10227;</span> Orbit
    </button>
    <div id="orbit-speed-container" title="Orbit rotation speed">
      <span id="orbit-speed-label">Speed:</span>
      <input type="range" id="orbit-speed-slider" min="1" max="10" value="5" step="0.5">
      <span id="orbit-speed-value">5.0</span>
    </div>
    <div id="nav-controls" title="Navigation history">
      <button id="nav-back" class="nav-btn disabled" title="Go back (Alt+Left)">
        <span>&#9664;</span>
      </button>
      <button id="nav-forward" class="nav-btn disabled" title="Go forward (Alt+Right)">
        <span>&#9654;</span>
      </button>
      <select id="recent-nodes" title="Recent nodes">
        <option value="">Recent nodes...</option>
      </select>
    </div>
    <div id="breadcrumb-trail" title="Current location path">
      <span class="breadcrumb-segment root">Project</span>
    </div>
    <div id="heat-decay-container">
      <span id="heat-decay-label">Heat:</span>
      <input type="range" id="heat-decay-slider" min="30" max="600" value="300" title="Heat decay duration (seconds)">
      <span id="heat-decay-value">5m</span>
    </div>
    <div id="flash-duration-container" title="Flash animation duration (milliseconds)">
      <span id="flash-duration-label">Flash:</span>
      <input type="range" id="flash-duration-slider" min="500" max="5000" value="2000" step="100">
      <span id="flash-duration-value">2s</span>
    </div>
    <div id="flash-intensity-container" title="Flash glow intensity multiplier">
      <span id="flash-intensity-label">Glow:</span>
      <input type="range" id="flash-intensity-slider" min="50" max="200" value="100" step="10">
      <span id="flash-intensity-value">1x</span>
    </div>
    <button id="follow-toggle" title="Auto-follow camera to changed files">
      <span class="follow-icon">&#9678;</span> Follow
    </button>
    <button id="trails-toggle" class="active" title="Toggle activity trails connecting changed files">
      <span class="trails-icon">&#9872;</span> Trails
    </button>
    <div id="trail-duration-container" title="Trail fade duration (seconds)">
      <span id="trail-duration-label">Trail:</span>
      <input type="range" id="trail-duration-slider" min="10" max="300" value="60" step="5">
      <span id="trail-duration-value">60s</span>
    </div>
    <button id="path-play" title="Play camera path through bookmarks (P key)">
      <span class="path-icon">&#9654;</span> Path
    </button>
    <span id="path-progress"></span>
    <button id="bookmark-btn" title="Save bookmark (Ctrl+1-9)">
      <span class="bookmark-icon">&#9733;</span>
      <span class="bookmark-count"></span>
    </button>
    <div id="branch-display" title="Current git branch">
      <span class="branch-icon">&#9095;</span>
      <span id="branch-name">&#8212;</span>
    </div>
    <span id="selected-path">No project selected</span>
  </div>
  <div id="refresh-indicator">Refreshing...</div>
  <button id="tree-toggle" class="panel-open" title="Toggle file tree"></button>
  <button id="activity-toggle" title="Toggle activity feed">
    <span>Activity</span>
    <span id="activity-badge"></span>
  </button>
  <button id="statistics-toggle" title="Toggle statistics panel">
    <span>&#128202; Stats</span>
  </button>
  <div id="activity-panel">
    <div id="activity-header">
      <h3>Activity Feed</h3>
      <div id="timeline-controls">
        <button id="timeline-play" title="Play/Pause timeline">&#9658;</button>
        <input type="range" id="timeline-scrubber" min="0" max="100" value="100" title="Timeline position">
        <span id="timeline-position">Live</span>
        <span id="timeline-live" class="visible">LIVE</span>
      </div>
      <button id="activity-clear">Clear</button>
    </div>
    <div id="activity-content">
      <div class="activity-empty">No recent activity</div>
    </div>
  </div>
  <div id="statistics-panel" class="panel collapsed">
    <div class="panel-header">
      <span>Activity Statistics</span>
      <button id="stats-refresh" title="Refresh statistics">&#8635;</button>
    </div>
    <div id="stats-content">
      <div class="stats-section">
        <h4>Most Edited Files</h4>
        <div id="stats-file-ranking"></div>
      </div>
      <div class="stats-section">
        <h4>Activity Over Time</h4>
        <div id="stats-chart"></div>
      </div>
    </div>
  </div>
  <div id="tree-panel" class="visible">
    <div id="tree-header">
      <h3> File Tree</h3>
    </div>
    <div id="tree-content"></div>
    <div id="tree-resizer"></div>
  </div>
  <div id="graph-container" class="tree-open"></div>
  <div id="color-legend">
    <div id="legend-header">
      <span class="legend-header-title">Legend</span>
      <span class="legend-toggle-icon"></span>
    </div>
    <div id="legend-content"></div>
  </div>
  <div id="minimap-panel">
    <div id="minimap-header">
      <span class="minimap-header-title">Minimap</span>
      <span class="minimap-toggle-icon"></span>
    </div>
    <div id="minimap-content">
      <canvas id="minimap-canvas" width="200" height="150"></canvas>
    </div>
  </div>
  <div id="tooltip"></div>
  <div id="details-panel" class="hidden">
    <button id="close-panel">&times;</button>
    <h2 id="panel-title"></h2>
    <div id="panel-content"></div>
  </div>
  <div id="file-inspector-overlay" class="hidden"></div>
  <div id="file-inspector-modal" class="hidden">
    <div class="modal-header">
      <h2 id="inspector-title"></h2>
      <div id="modal-search-container" class="hidden">
        <input type="text" id="modal-search-input" placeholder="Search in file...">
        <span id="modal-search-info"></span>
        <div id="modal-search-nav">
          <button id="search-prev" title="Previous match"></button>
          <button id="search-next" title="Next match"></button>
        </div>
        <button id="search-close" title="Close search"></button>
      </div>
      <button id="inspector-close">&times;</button>
    </div>
    <div class="modal-body">
      <div class="collapsible-section" id="section-diff">
        <div class="section-header">
          <span class="section-toggle">&#9660;</span>
          <span class="section-title">Diff</span>
          <div class="diff-mode-toggle">
            <button class="mode-btn active" data-mode="git">Git Diff</button>
            <button class="mode-btn" data-mode="session">Session Diff</button>
          </div>
        </div>
        <div class="section-content">
          <div class="diff-status">Loading...</div>
        </div>
      </div>
      <div class="collapsible-section" id="section-structure">
        <div class="section-header">
          <span class="section-toggle">&#9660;</span>
          <span class="section-title">Structure</span>
        </div>
        <div class="section-content">
          <p class="section-placeholder">File structure tree will appear here (Phase 15)</p>
        </div>
      </div>
      <div class="collapsible-section" id="section-context">
        <div class="section-header">
          <span class="section-toggle">&#9660;</span>
          <span class="section-title">Context</span>
        </div>
        <div class="section-content">
          <p class="section-placeholder">File context and metadata will appear here (Phase 16)</p>
        </div>
      </div>
    </div>
  </div>
  <!-- Bookmark Save Dialog -->
  <div id="bookmark-dialog-overlay" class="hidden"></div>
  <div id="bookmark-dialog" class="hidden">
    <div class="dialog-header">
      <h3>Save Bookmark</h3>
      <button id="bookmark-dialog-close">&times;</button>
    </div>
    <div class="dialog-body">
      <div class="dialog-field">
        <label for="bookmark-name">Name:</label>
        <input type="text" id="bookmark-name" placeholder="Enter bookmark name..." maxlength="30">
      </div>
      <div class="dialog-field">
        <label>Slot:</label>
        <div id="bookmark-slots" class="bookmark-slots"></div>
      </div>
      <div class="dialog-info">
        <p id="bookmark-current-info"></p>
      </div>
      <div class="bookmark-list-section">
        <label>Saved Bookmarks:</label>
        <div id="bookmark-list"></div>
      </div>
    </div>
    <div class="dialog-footer">
      <button id="bookmark-save-btn" class="primary">Save</button>
      <button id="bookmark-cancel-btn" class="secondary">Cancel</button>
    </div>
  </div>
  <script src="./bundle.js"></script>
</body>
</html>
