# Plan 05-04: External editor integration

## Goal
User can open the underlying file in their external editor from any node.

## Tasks

1. Add IPC handler in main process to open files with system default app
2. Expose openFile API in preload
3. Add "Open in Editor" button to details panel
4. Handle file path resolution for different node types

## Implementation

### Main process (main.js):
```javascript
const { shell } = require('electron');

ipcMain.handle('open-file', async (event, filePath) => {
  try {
    await shell.openPath(filePath);
    return { success: true };
  } catch (error) {
    return { error: error.message };
  }
});
```

### Preload (preload.js):
```javascript
openFile: (filePath) => ipcRenderer.invoke('open-file', filePath)
```

### Renderer - Add button to details panel:
```javascript
function showDetailsPanel(node) {
  // ... existing code ...

  // Add open button for file/directory nodes or nodes with file path
  const filePath = node.path || node.file;
  if (filePath && selectedProjectPath) {
    const fullPath = node.path
      ? path.join(selectedProjectPath, '.planning', node.path)
      : path.join(selectedProjectPath, '.planning', 'phases', node.file);

    html += `<button id="open-file-btn" class="panel-btn">Open in Editor</button>`;
  }

  content.innerHTML = html;

  // Add click handler for open button
  const openBtn = document.getElementById('open-file-btn');
  if (openBtn) {
    openBtn.addEventListener('click', async () => {
      const fullPath = node.path
        ? `${selectedProjectPath}/.planning/${node.path}`
        : `${selectedProjectPath}/.planning/phases/${node.file}`;
      await window.electronAPI.openFile(fullPath);
    });
  }
}
```

### CSS for button:
```css
.panel-btn {
  margin-top: 15px;
  padding: 8px 16px;
  background: #4ECDC4;
  border: none;
  border-radius: 4px;
  color: #1a1a2e;
  cursor: pointer;
  font-weight: bold;
}

.panel-btn:hover {
  background: #45B7D1;
}
```

## Verification
- Click a file/plan node
- Details panel shows "Open in Editor" button
- Click button opens file in system default editor
