---
phase: 19-enhanced-flash-effects
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/renderer/renderer.js
  - src/renderer/index.html
autonomous: true

must_haves:
  truths:
    - "Flash effects are visible from any zoom level or viewing angle"
    - "Created files flash with bright green pulse pattern"
    - "Modified files flash with bright orange/yellow pulse pattern"
    - "Deleted files flash with bright red pulse pattern before fading"
  artifacts:
    - path: "src/renderer/renderer.js"
      provides: "Enhanced flashNodeWithType function"
      contains: "emissive"
    - path: "src/renderer/index.html"
      provides: "Updated tree flash CSS"
      contains: "tree-flash"
  key_links:
    - from: "flashNodeWithType"
      to: "THREE.js material"
      via: "emissive property and scale animation"
      pattern: "material\\.emissive"
---

<objective>
Make flash animations dramatically more visible with brighter colors, emissive glow effects, and scale pulsing.

Purpose: User complained that current flash effects are hard to see. This plan implements eye-catching animations that are unmistakable at any zoom level.
Output: Enhanced flash animations using emissive glow, brighter colors, and scale pulsing for all three change types.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@src/renderer/renderer.js (lines 776-866 - current flashNodeWithType implementation)
@src/renderer/index.html (lines 505-545 - current tree flash CSS)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Enhance 3D flash animation with emissive glow and scale pulse</name>
  <files>src/renderer/renderer.js</files>
  <action>
Modify `flashNodeWithType()` function (around line 776) to make flashes MUCH more visible:

1. Add brighter flash colors (increase saturation and lightness):
   - created: 0x00FF88 (bright neon green, was 0x2ECC71)
   - modified: 0xFFAA00 (bright amber/orange, was 0xF39C12)
   - deleted: 0xFF3333 (bright red, was 0xE74C3C)

2. Add emissive glow effect:
   - Store original emissive color at start
   - During pulse peaks, set material.emissive to flash color
   - Use emissiveIntensity to control glow brightness (pulse 0 to 2.0)
   - Restore original emissive at end

3. Add scale pulsing:
   - Store original scale at animation start
   - Pulse scale from 1.0 to 1.5 during animation peaks
   - Use smoother ease-in-out curve (Math.sin squared)
   - Restore original scale at end

4. Different patterns per change type:
   - Created: 4 quick pulses with increasing intensity (celebration effect)
   - Modified: 3 steady pulses (attention-getting)
   - Deleted: 2 slow pulses then fade (warning effect)

5. Keep existing duration (2000ms) as default but prepare for configurability by using a variable:
   - Add `let flashDuration = 2000;` at top of file near heat config
   - Add `let flashIntensity = 1.0;` for multiplier

Key implementation approach:
```javascript
// In animate() function:
// Emissive glow
if (material.emissive) {
  const emissiveIntensity = intensity * flashIntensity * 2.0;
  material.emissive.setHex(flashColor);
  material.emissiveIntensity = emissiveIntensity;
}

// Scale pulse
const scaleMultiplier = 1 + (intensity * 0.5 * flashIntensity);
threeObj.scale.set(
  originalScale.x * scaleMultiplier,
  originalScale.y * scaleMultiplier,
  originalScale.z * scaleMultiplier
);
```

Store originalEmissive and originalScale in the flashingNodes Map entry for proper restoration.
  </action>
  <verify>
1. `npm run build` completes without errors
2. Start app with `npm start`
3. Create a new file in watched directory - green flash with glow and scale pulse visible
4. Modify a file - orange flash with glow and scale pulse visible
5. Delete a file - red flash with glow, then node fades out
6. Flash effects visible when zoomed out to see entire graph
  </verify>
  <done>
3D graph nodes display bright, eye-catching flash animations with emissive glow and scale pulsing. Each change type (create/modify/delete) has a distinct, unmistakable visual pattern.
  </done>
</task>

<task type="auto">
  <name>Task 2: Enhance tree panel flash CSS with brighter animations</name>
  <files>src/renderer/index.html</files>
  <action>
Update the tree flash CSS animations (around line 505) to match the enhanced 3D effects:

1. Use brighter, more saturated colors matching the new 3D colors:
   - created: rgba(0, 255, 136, ...) - neon green
   - modified: rgba(255, 170, 0, ...) - bright amber
   - deleted: rgba(255, 51, 51, ...) - bright red

2. Increase box-shadow intensity and spread for glow effect:
   - 0% keyframe: 0 0 20px (was 15px), rgba alpha 0.9
   - Peak keyframes: 0 0 25px with higher alpha
   - Add inset shadow for inner glow: inset 0 0 10px

3. Add text-shadow for extra visibility:
   - text-shadow: 0 0 8px {color} during peak flash

4. Increase animation contrast:
   - 0% background alpha 1.0 (fully saturated)
   - Low points at alpha 0.1 (near invisible for contrast)
   - More pulses (4 for created, 3 for modified, 2 for deleted)

5. Match pulse patterns to 3D:
   - tree-flash-created: Fast pulses at 0%, 20%, 40%, 60%, 80%
   - tree-flash-modified: Steady pulses at 0%, 33%, 66%
   - tree-flash-deleted: Two slow pulses at 0%, 50%, then fade

Example for created:
```css
@keyframes tree-flash-created {
  0% {
    background-color: rgba(0, 255, 136, 1.0);
    box-shadow: 0 0 20px rgba(0, 255, 136, 0.9), inset 0 0 10px rgba(0, 255, 136, 0.5);
    text-shadow: 0 0 8px rgba(0, 255, 136, 0.8);
  }
  10% { background-color: rgba(0, 255, 136, 0.1); box-shadow: none; text-shadow: none; }
  20% { background-color: rgba(0, 255, 136, 0.95); box-shadow: 0 0 25px rgba(0, 255, 136, 0.85); text-shadow: 0 0 8px rgba(0, 255, 136, 0.7); }
  30% { background-color: rgba(0, 255, 136, 0.1); box-shadow: none; text-shadow: none; }
  /* ... more pulses ... */
  100% { background-color: transparent; box-shadow: none; text-shadow: none; }
}
```
  </action>
  <verify>
1. File changes trigger tree flash animations
2. Created files: bright green multi-pulse flash visible in tree panel
3. Modified files: bright amber/orange flash visible
4. Deleted files: bright red flash before item fades
5. Flash is clearly visible even when scrolled to different part of tree
  </verify>
  <done>
Tree panel flash animations are dramatically brighter with matching colors, glow effects, and pulse patterns that complement the 3D graph animations.
  </done>
</task>

</tasks>

<verification>
1. Build succeeds: `npm run build`
2. App launches: `npm start`
3. Create file test: Touch a new .txt file in src/ - both graph AND tree show bright green flash
4. Modify file test: Edit existing file - both show bright orange flash
5. Delete file test: Remove file - both show bright red flash, then fade
6. Zoom test: Flash visible when zoomed out to see all nodes
7. Visual consistency: Graph and tree flash animations feel cohesive (same colors, similar timing)
</verification>

<success_criteria>
1. Flash effects are bright enough to notice immediately at any zoom level
2. Created files have distinct green pulse pattern (4 quick pulses)
3. Modified files have distinct orange/yellow pulse pattern (3 steady pulses)
4. Deleted files have distinct red pulse pattern (2 slow pulses) before fading
5. Both 3D graph and tree panel show matching enhanced flash animations
</success_criteria>

<output>
After completion, create `.planning/phases/19-enhanced-flash-effects/19-01-SUMMARY.md`
</output>
