---
phase: 23-breadcrumb-trail
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/renderer/renderer.js
  - src/renderer/index.html
autonomous: true

must_haves:
  truths:
    - "User can see hierarchy path from project root to currently selected node"
    - "Breadcrumb shows node names separated by visual separator (e.g., Project / src / components / Graph.js)"
    - "Clicking any breadcrumb segment navigates camera to that ancestor node"
    - "Breadcrumb updates automatically when user selects different node"
  artifacts:
    - path: "src/renderer/renderer.js"
      provides: "Breadcrumb path building and update logic"
      contains: "buildBreadcrumbPath|updateBreadcrumb"
    - path: "src/renderer/index.html"
      provides: "Breadcrumb UI container and styles"
      contains: "breadcrumb-trail"
  key_links:
    - from: "showDetailsPanel"
      to: "updateBreadcrumb"
      via: "Function call when node selected"
      pattern: "updateBreadcrumb.*selectedNode"
    - from: "breadcrumb click handler"
      to: "flyToNodeSmooth + showDetailsPanel"
      via: "Event delegation for navigation"
      pattern: "flyToNodeSmooth.*showDetailsPanel"
---

<objective>
Implement breadcrumb trail navigation showing the hierarchy path from project root to the currently selected node, with clickable segments for ancestor navigation.

Purpose: Users need spatial context when deep in the file hierarchy. The breadcrumb shows "where I am" and provides quick navigation to parent directories without manual back-tracking.

Output: Breadcrumb UI component that displays path and updates on selection, with click-to-navigate functionality.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@src/renderer/renderer.js (lines 230-280 for node ID format, lines 3560-3600 for showDetailsPanel)
@src/renderer/index.html (toolbar structure)

Key patterns:
- Node IDs: `{sourceType}-{type}-{path}` (e.g., `planning-dir-phases`, `src-file-renderer/renderer.js`)
- Root directories: `dir-planning`, `dir-src`
- flyToNodeSmooth(nodeId, distance) for camera transitions
- showDetailsPanel(node) sets selectedNode and updates UI
- currentGraphData.nodes contains all graph nodes
</context>

<tasks>

<task type="auto">
  <name>Task 1: Breadcrumb path building and state logic</name>
  <files>src/renderer/renderer.js</files>
  <action>
Add breadcrumb path building logic to renderer.js:

1. Create `buildBreadcrumbPath(node)` function that:
   - Takes a node object (with id, name, path, sourceType, type)
   - Returns array of ancestor objects: [{id, name, isRoot}, ...]
   - For a node like `src-file-renderer/renderer.js`:
     - Start with root: {id: 'dir-src', name: 'src', isRoot: true}
     - Add each path segment: {id: 'src-dir-renderer', name: 'renderer', isRoot: false}
     - End with current node: {id: node.id, name: node.name, isRoot: false}
   - For planning files, root is 'dir-planning' with name '.planning'
   - Handle edge case: if node IS a root directory, return just that segment

2. Create `updateBreadcrumb(node)` function that:
   - Calls buildBreadcrumbPath(node)
   - Updates the breadcrumb-trail element with clickable segments
   - Each segment except current is a clickable link
   - Current node (last segment) is styled differently (not clickable)
   - Use "/" as visual separator between segments

3. Integrate into showDetailsPanel():
   - Call updateBreadcrumb(node) after setting selectedNode
   - For non-file/directory nodes (commits, phases, etc.), show simpler breadcrumb or hide

4. Add click handler using event delegation on breadcrumb-trail:
   - On click of segment with data-node-id attribute:
   - Find node in currentGraphData.nodes by id
   - If found, call flyToNodeSmooth(nodeId, 80) then showDetailsPanel(node)
  </action>
  <verify>
Console test: Select a deeply nested file node, verify buildBreadcrumbPath returns correct ancestor chain from root to current node. Click an ancestor segment, verify camera navigates to that node.
  </verify>
  <done>
buildBreadcrumbPath correctly parses node hierarchy, updateBreadcrumb renders clickable path, clicking ancestor navigates to that node.
  </done>
</task>

<task type="auto">
  <name>Task 2: Breadcrumb UI component and styling</name>
  <files>src/renderer/index.html</files>
  <action>
Add breadcrumb UI to index.html:

1. Add breadcrumb container element in toolbar area (after nav-controls, before heat-decay-container):
```html
<div id="breadcrumb-trail" title="Current location path">
  <span class="breadcrumb-segment root" data-node-id="">Project</span>
</div>
```

2. Add CSS styles for breadcrumb:
```css
#breadcrumb-trail {
  display: flex;
  align-items: center;
  gap: 4px;
  font-size: 12px;
  color: #888;
  max-width: 400px;
  overflow: hidden;
  margin-left: 8px;
}

.breadcrumb-segment {
  color: #4ECDC4;
  cursor: pointer;
  white-space: nowrap;
  transition: color 0.2s;
}

.breadcrumb-segment:hover {
  color: #45B7D1;
  text-decoration: underline;
}

.breadcrumb-segment.current {
  color: #fff;
  cursor: default;
}

.breadcrumb-segment.current:hover {
  text-decoration: none;
}

.breadcrumb-separator {
  color: #555;
  font-size: 10px;
}

/* When breadcrumb overflows, fade left edge */
#breadcrumb-trail::before {
  content: '';
  position: absolute;
  left: 0;
  top: 0;
  bottom: 0;
  width: 20px;
  background: linear-gradient(to right, rgba(26, 26, 46, 0.95), transparent);
  pointer-events: none;
  opacity: 0;
  transition: opacity 0.2s;
}

#breadcrumb-trail.overflow::before {
  opacity: 1;
}
```

3. Position breadcrumb in toolbar:
   - Add `position: relative` to #breadcrumb-trail for the fade effect
   - Ensure breadcrumb is flexible and doesn't push other toolbar items
   - On small screens, breadcrumb should truncate gracefully (overflow: hidden with text-overflow)
  </action>
  <verify>
Visual check: Breadcrumb appears in toolbar, shows "Project" initially. When node selected, shows full path like "src / renderer / renderer.js". Hover state on non-current segments shows underline and color change.
  </verify>
  <done>
Breadcrumb UI visible in toolbar with correct styling, segments are visually distinct, current node styled differently from clickable ancestors.
  </done>
</task>

</tasks>

<verification>
1. Select a deeply nested file (e.g., src/renderer/renderer.js)
   - Breadcrumb shows: "src / renderer / renderer.js"
   - "src" and "renderer" are clickable (teal color)
   - "renderer.js" is current (white, not clickable)

2. Click "src" segment
   - Camera navigates to src directory node
   - Details panel shows src directory info
   - Breadcrumb updates to just "src"

3. Click "renderer" segment
   - Camera navigates to renderer directory node
   - Breadcrumb shows "src / renderer"

4. Select a .planning file
   - Breadcrumb shows: ".planning / phases / 23-breadcrumb-trail / PLAN.md" (or similar)

5. Select root directory (src or .planning)
   - Breadcrumb shows just that root name
</verification>

<success_criteria>
- Breadcrumb trail displays path from project root to currently selected node
- Each breadcrumb segment shows node name with "/" separators
- Clicking any non-current breadcrumb segment navigates camera to that ancestor
- Breadcrumb updates automatically when user selects different node
- UI matches app's teal/cyan color scheme
- Handles both src/ and .planning/ hierarchies correctly
</success_criteria>

<output>
After completion, create `.planning/phases/23-breadcrumb-trail/23-01-SUMMARY.md`
</output>
