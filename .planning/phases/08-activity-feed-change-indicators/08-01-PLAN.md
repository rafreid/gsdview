---
phase: 08-activity-feed-change-indicators
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/renderer/index.html
  - src/renderer/renderer.js
autonomous: true

must_haves:
  truths:
    - "Activity feed panel is visible at bottom of window"
    - "Toggle button shows/hides the feed panel"
    - "Panel has header with title and clear button"
    - "Badge shows unread count when panel is collapsed"
  artifacts:
    - path: "src/renderer/index.html"
      provides: "Activity feed panel HTML structure"
      contains: "activity-feed"
    - path: "src/renderer/renderer.js"
      provides: "Feed panel toggle functionality"
      contains: "activity-feed"
  key_links:
    - from: "src/renderer/index.html"
      to: "src/renderer/renderer.js"
      via: "DOM element IDs"
      pattern: "activity-feed|activity-toggle"
---

<objective>
Create the activity feed panel UI structure with collapsible toggle and badge indicator.

Purpose: Establish the visual foundation for displaying real-time file changes in a dev-tools-style bottom panel.
Output: Collapsible activity feed panel at bottom of window with toggle button showing badge count when collapsed.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/08-activity-feed-change-indicators/08-CONTEXT.md
@src/renderer/index.html
@src/renderer/renderer.js
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add activity feed panel HTML structure</name>
  <files>src/renderer/index.html</files>
  <action>
Add the activity feed panel HTML structure to index.html, placed BEFORE the graph-container div:

1. Create toggle button `#activity-toggle` (similar to tree-toggle):
   - Position: fixed at bottom-left corner
   - Default text: activity icon (use text "Activity" or icon)
   - Will show badge when collapsed

2. Create activity panel `#activity-panel`:
   - Position: fixed at bottom of window
   - Width: 100%
   - Height: ~180px (shows 4-6 entries at ~30px each)
   - Initially hidden (transform: translateY(100%))

3. Panel internal structure:
   - `#activity-header`: title "Activity Feed" + clear button
   - `#activity-content`: scrollable container for entries
   - Each entry will have class `activity-entry`

4. Add CSS styles following existing patterns (tree-panel, details-panel):
   - Background: rgba(26, 26, 46, 0.98) to match other panels
   - Border-top: 1px solid #333
   - Toggle button: similar to tree-toggle styling
   - Badge styling: small red circle with white text
   - Entry colors for change types:
     - .activity-entry.created: green accent (#2ECC71)
     - .activity-entry.modified: orange accent (#F39C12)
     - .activity-entry.deleted: red accent (#E74C3C)
   - Scrollbar styling for activity-content

5. Adjust graph-container CSS:
   - Add .activity-open class that reduces height when panel is visible

CSS variables/colors to use:
- Background: rgba(26, 26, 46, 0.98)
- Border: #333
- Accent: #4ECDC4 (teal for headers)
- Create: #2ECC71 (green)
- Modify: #F39C12 (orange)
- Delete: #E74C3C (red)
  </action>
  <verify>
Open index.html in browser or run `npm start`. Visual inspection shows:
- Toggle button visible at bottom-left
- Clicking toggle shows/hides panel (via CSS only, no JS yet)
- Panel has correct styling and position
  </verify>
  <done>
Activity feed panel HTML and CSS added. Panel structure complete with header, content area, and entry styling classes. Toggle button positioned at bottom-left.
  </done>
</task>

<task type="auto">
  <name>Task 2: Implement feed panel toggle and badge functionality</name>
  <files>src/renderer/renderer.js</files>
  <action>
Add JavaScript for feed panel toggle and badge counter following tree-toggle pattern:

1. Add state variables at top of file:
   ```javascript
   let activityEntries = []; // Array of {id, path, event, timestamp, sourceType}
   let activityUnreadCount = 0; // Badge counter
   ```

2. Add toggle handler (after tree-toggle handler, around line 1460):
   ```javascript
   // Activity feed toggle button handler
   document.getElementById('activity-toggle').addEventListener('click', () => {
     const panel = document.getElementById('activity-panel');
     const toggle = document.getElementById('activity-toggle');
     const graphContainer = document.getElementById('graph-container');

     panel.classList.toggle('visible');
     toggle.classList.toggle('panel-open');
     graphContainer.classList.toggle('activity-open');

     // Clear unread count when opening
     if (panel.classList.contains('visible')) {
       activityUnreadCount = 0;
       updateActivityBadge();
     }

     // Resize graph
     setTimeout(() => handleResize(), 300);
   });
   ```

3. Add badge update function:
   ```javascript
   function updateActivityBadge() {
     const badge = document.getElementById('activity-badge');
     if (!badge) return;

     if (activityUnreadCount > 0) {
       badge.textContent = activityUnreadCount > 99 ? '99+' : activityUnreadCount;
       badge.classList.add('visible');
     } else {
       badge.classList.remove('visible');
     }
   }
   ```

4. Add clear button handler:
   ```javascript
   document.getElementById('activity-clear').addEventListener('click', () => {
     activityEntries = [];
     activityUnreadCount = 0;
     updateActivityBadge();
     updateActivityPanel();
   });
   ```

5. Add placeholder updateActivityPanel function (will be completed in Plan 02):
   ```javascript
   function updateActivityPanel() {
     const content = document.getElementById('activity-content');
     if (!content) return;

     if (activityEntries.length === 0) {
       content.innerHTML = '<div class="activity-empty">No recent activity</div>';
       return;
     }

     // Full implementation in Plan 02
     content.innerHTML = activityEntries.map(entry =>
       `<div class="activity-entry ${entry.event}">${entry.path}</div>`
     ).join('');
   }
   ```

6. Update handleResize function to account for activity panel:
   - Add activity panel height check similar to tree panel width check
  </action>
  <verify>
Run `npm start`, open a project:
1. Activity toggle button visible at bottom-left
2. Click toggle -> panel slides up from bottom
3. Click again -> panel slides down
4. Graph resizes correctly when panel opens/closes
5. Clear button clears the panel (shows empty message)
  </verify>
  <done>
Activity feed panel toggle working. Badge updates when activity occurs while panel is closed. Clear button removes all entries. Graph container resizes correctly.
  </done>
</task>

</tasks>

<verification>
- [ ] Activity feed toggle button appears at bottom-left of window
- [ ] Clicking toggle shows/hides the bottom panel with smooth animation
- [ ] Panel has correct structure: header with title + clear button, scrollable content area
- [ ] Graph container resizes when activity panel opens (reduces height)
- [ ] Clear button empties the activity list
- [ ] Badge element exists (visible styling tested in Plan 02)
- [ ] CSS classes for entry types exist (.created, .modified, .deleted)
</verification>

<success_criteria>
Activity feed panel UI foundation is complete:
1. Panel toggles visibility smoothly
2. Panel has correct visual styling matching existing panels
3. Badge container ready for unread count display
4. Clear functionality works
5. Entry CSS classes defined for color-coding
</success_criteria>

<output>
After completion, create `.planning/phases/08-activity-feed-change-indicators/08-01-SUMMARY.md`
</output>
