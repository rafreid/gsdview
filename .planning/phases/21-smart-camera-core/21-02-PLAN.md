---
phase: 21-smart-camera-core
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - src/renderer/renderer.js
  - src/renderer/index.html
autonomous: true

must_haves:
  truths:
    - "Overview zoom button instantly zooms out to show entire graph"
    - "Focus zoom button centers on selected node at medium distance"
    - "Detail zoom button zooms close to selected node for file inspection"
  artifacts:
    - path: "src/renderer/renderer.js"
      provides: "Zoom preset functions"
      contains: "zoomToOverview"
    - path: "src/renderer/index.html"
      provides: "Zoom preset buttons"
      contains: "zoom-overview"
  key_links:
    - from: "zoom-overview button"
      to: "zoomToOverview function"
      via: "click event"
      pattern: "zoom-overview.*addEventListener"
    - from: "zoom-focus button"
      to: "zoomToFocus function"
      via: "click event"
      pattern: "zoom-focus.*addEventListener"
    - from: "zoom-detail button"
      to: "zoomToDetail function"
      via: "click event"
      pattern: "zoom-detail.*addEventListener"
---

<objective>
Implement zoom preset buttons for quick navigation: Overview (see all), Focus (selected node at medium distance), Detail (close-up).

Purpose: Users often need to quickly switch between seeing the whole graph and focusing on specific nodes. Preset buttons provide one-click access to common zoom levels.

Output: Three zoom buttons in a button group that instantly navigate to predefined zoom levels.
</objective>

<execution_context>
@./.claude/get-shit-done/workflows/execute-plan.md
@./.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@src/renderer/renderer.js (cameraPosition at lines 1917-1935, is3D mode check, selectedNode variable)
@src/renderer/index.html (toolbar at lines 2250-2278, button styling patterns)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Zoom preset functions</name>
  <files>src/renderer/renderer.js</files>
  <action>
Add three zoom preset functions (after the flyToNodeSmooth function or around line 1960):

1. `zoomToOverview()` - Show entire graph:
```javascript
// Zoom preset: Overview - show entire graph
function zoomToOverview() {
  if (!Graph || !currentGraphData || currentGraphData.nodes.length === 0) return;

  // Calculate bounding box of all nodes
  let minX = Infinity, maxX = -Infinity;
  let minY = Infinity, maxY = -Infinity;
  let minZ = Infinity, maxZ = -Infinity;

  currentGraphData.nodes.forEach(node => {
    if (node.x !== undefined) {
      minX = Math.min(minX, node.x);
      maxX = Math.max(maxX, node.x);
      minY = Math.min(minY, node.y);
      maxY = Math.max(maxY, node.y);
      minZ = Math.min(minZ, node.z || 0);
      maxZ = Math.max(maxZ, node.z || 0);
    }
  });

  // Calculate center and required distance
  const centerX = (minX + maxX) / 2;
  const centerY = (minY + maxY) / 2;
  const centerZ = (minZ + maxZ) / 2;

  const spanX = maxX - minX;
  const spanY = maxY - minY;
  const spanZ = maxZ - minZ;
  const maxSpan = Math.max(spanX, spanY, spanZ, 100);

  // Distance based on graph size (with padding)
  const distance = maxSpan * 1.5;

  if (is3D) {
    Graph.cameraPosition(
      { x: centerX + distance * 0.5, y: centerY + distance * 0.5, z: centerZ + distance },
      { x: centerX, y: centerY, z: centerZ },
      1000
    );
  } else {
    Graph.cameraPosition(
      { x: centerX, y: centerY, z: distance + 200 },
      { x: centerX, y: centerY, z: 0 },
      1000
    );
  }

  console.log('[Camera] Zoom to overview');
}
```

2. `zoomToFocus()` - Selected node at medium distance:
```javascript
// Zoom preset: Focus - selected node at medium distance
function zoomToFocus() {
  if (!Graph || !selectedNode) {
    console.log('[Camera] No node selected for focus zoom');
    return;
  }

  const node = currentGraphData.nodes.find(n => n.id === selectedNode.id);
  if (!node || node.x === undefined) return;

  const distance = 120; // Medium distance for context

  if (is3D) {
    const distRatio = 1 + distance / Math.hypot(node.x || 0, node.y || 0, node.z || 0);
    Graph.cameraPosition(
      {
        x: (node.x || 0) * distRatio,
        y: (node.y || 0) * distRatio,
        z: (node.z || 0) * distRatio
      },
      node,
      1000
    );
  } else {
    Graph.cameraPosition(
      { x: node.x || 0, y: node.y || 0, z: distance + 100 },
      node,
      1000
    );
  }

  console.log('[Camera] Zoom to focus on:', selectedNode.id);
}
```

3. `zoomToDetail()` - Close-up on selected node:
```javascript
// Zoom preset: Detail - close-up on selected node
function zoomToDetail() {
  if (!Graph || !selectedNode) {
    console.log('[Camera] No node selected for detail zoom');
    return;
  }

  const node = currentGraphData.nodes.find(n => n.id === selectedNode.id);
  if (!node || node.x === undefined) return;

  const distance = 40; // Close distance for inspection

  if (is3D) {
    const distRatio = 1 + distance / Math.hypot(node.x || 0, node.y || 0, node.z || 0);
    Graph.cameraPosition(
      {
        x: (node.x || 0) * distRatio,
        y: (node.y || 0) * distRatio,
        z: (node.z || 0) * distRatio
      },
      node,
      1000
    );
  } else {
    Graph.cameraPosition(
      { x: node.x || 0, y: node.y || 0, z: distance + 50 },
      node,
      1000
    );
  }

  console.log('[Camera] Zoom to detail on:', selectedNode.id);
}
```
  </action>
  <verify>
Check renderer.js contains:
- zoomToOverview function with bounding box calculation
- zoomToFocus function checking selectedNode
- zoomToDetail function with close distance
  </verify>
  <done>Three zoom preset functions exist with appropriate distance calculations</done>
</task>

<task type="auto">
  <name>Task 2: Zoom preset button UI</name>
  <files>src/renderer/index.html, src/renderer/renderer.js</files>
  <action>
1. In index.html, add zoom button group after dimension-toggle (around line 2250):
```html
<button id="dimension-toggle" title="Toggle between 2D and 3D view">3D</button>
<div id="zoom-presets" title="Quick zoom presets">
  <button id="zoom-overview" class="zoom-btn" title="Zoom out to see entire graph">
    <span>&#128269;-</span>
  </button>
  <button id="zoom-focus" class="zoom-btn" title="Focus on selected node (medium distance)">
    <span>&#9678;</span>
  </button>
  <button id="zoom-detail" class="zoom-btn" title="Detail view of selected node (close-up)">
    <span>&#128269;+</span>
  </button>
</div>
```

2. Add CSS styles for zoom preset buttons (after dimension-toggle styles, around line 1050):
```css
/* Zoom Preset Buttons */
#zoom-presets {
  display: flex;
  align-items: center;
  gap: 2px;
  margin-left: 10px;
  padding: 2px;
  background: rgba(255, 255, 255, 0.05);
  border-radius: 4px;
}

.zoom-btn {
  display: flex;
  align-items: center;
  justify-content: center;
  width: 28px;
  height: 24px;
  background: rgba(100, 149, 237, 0.15);
  border: 1px solid rgba(100, 149, 237, 0.3);
  border-radius: 3px;
  color: rgba(100, 149, 237, 0.8);
  font-size: 12px;
  cursor: pointer;
  transition: all 0.2s;
}

.zoom-btn:hover {
  background: rgba(100, 149, 237, 0.3);
  border-color: rgba(100, 149, 237, 0.6);
  color: #6495ED;
}

.zoom-btn:active {
  background: rgba(100, 149, 237, 0.4);
  transform: scale(0.95);
}

.zoom-btn span {
  font-size: 14px;
}

/* Disable state for focus/detail when no node selected */
.zoom-btn.disabled {
  opacity: 0.4;
  cursor: not-allowed;
  pointer-events: none;
}
```
Note: Uses cornflower blue (#6495ED) for camera/zoom controls.

3. In renderer.js, add event listeners for zoom buttons (near other button listeners, around line 5560):
```javascript
// Zoom preset buttons
document.getElementById('zoom-overview')?.addEventListener('click', () => {
  zoomToOverview();
});

document.getElementById('zoom-focus')?.addEventListener('click', () => {
  zoomToFocus();
});

document.getElementById('zoom-detail')?.addEventListener('click', () => {
  zoomToDetail();
});
```

4. Add function to update zoom button states based on selection (call when selectedNode changes):
```javascript
// Update zoom button states based on selection
function updateZoomButtonStates() {
  const focusBtn = document.getElementById('zoom-focus');
  const detailBtn = document.getElementById('zoom-detail');

  if (selectedNode) {
    focusBtn?.classList.remove('disabled');
    detailBtn?.classList.remove('disabled');
  } else {
    focusBtn?.classList.add('disabled');
    detailBtn?.classList.add('disabled');
  }
}
```

5. Call updateZoomButtonStates() in the node click handler (where selectedNode is set) and on initial load.
  </action>
  <verify>
Run `npm run build` and `npm start`.
1. Zoom button group appears in toolbar (3 buttons: -, o, +)
2. Click Overview (-) - camera zooms out to show entire graph
3. Select a node, click Focus (o) - camera moves to medium distance from node
4. Click Detail (+) - camera moves very close to selected node
5. Without selection, Focus and Detail buttons appear disabled/grayed
6. Buttons have visual feedback on hover and click
  </verify>
  <done>Zoom preset buttons work and provide quick access to overview/focus/detail zoom levels</done>
</task>

</tasks>

<verification>
1. Build passes: `npm run build`
2. App launches: `npm start`
3. Zoom button group visible in toolbar with blue theme
4. Overview button: Zooms to show all nodes with margin
5. Focus button (with node selected): Zooms to node at ~120 distance
6. Detail button (with node selected): Zooms to node at ~40 distance
7. Focus/Detail disabled when no node selected
8. All transitions are smooth (1000ms)
9. Works in both 2D and 3D modes
</verification>

<success_criteria>
- Three zoom buttons appear in a grouped layout
- Overview shows entire graph regardless of selection
- Focus centers on selected node at medium distance
- Detail zooms close to selected node for inspection
- Buttons disabled appropriately when no selection
- Smooth camera transitions in all cases
</success_criteria>

<output>
After completion, create `.planning/phases/21-smart-camera-core/21-02-SUMMARY.md`
</output>
